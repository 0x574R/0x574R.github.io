<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 560 180" preserveAspectRatio="xMidYMid meet">
  <defs>
    <linearGradient id="bg" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0a0a12"/>
      <stop offset="100%" style="stop-color:#12101a"/>
    </linearGradient>
    <linearGradient id="tracer-grad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#1e3a5f"/>
      <stop offset="100%" style="stop-color:#0f1d2f"/>
    </linearGradient>
    <linearGradient id="tracee-grad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#3d1a4a"/>
      <stop offset="100%" style="stop-color:#1f0d26"/>
    </linearGradient>
    <filter id="glow-cyan">
      <feGaussianBlur stdDeviation="2" result="blur"/>
      <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
    <filter id="glow-purple">
      <feGaussianBlur stdDeviation="1.5" result="blur"/>
      <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
  </defs>
  
  <!-- Fondo -->
  <rect width="560" height="180" fill="url(#bg)"/>
  
  <!-- Grid sutil -->
  <g stroke="#1a1a2e" stroke-width="0.5" opacity="0.4">
    <line x1="0" y1="45" x2="560" y2="45"/>
    <line x1="0" y1="90" x2="560" y2="90"/>
    <line x1="0" y1="135" x2="560" y2="135"/>
    <line x1="140" y1="0" x2="140" y2="180"/>
    <line x1="280" y1="0" x2="280" y2="180"/>
    <line x1="420" y1="0" x2="420" y2="180"/>
  </g>
  
  <!-- TRACER Process Box -->
  <g transform="translate(35, 25)">
    <rect width="150" height="130" rx="6" fill="url(#tracer-grad)" stroke="#4a90d9" stroke-width="1.5"/>
    <rect width="150" height="24" rx="6" fill="#1e3a5f"/>
    <rect y="20" width="150" height="4" fill="#1e3a5f"/>
    <circle cx="12" cy="12" r="4" fill="#4a90d9"/>
    <circle cx="26" cy="12" r="4" fill="#2d5a87"/>
    <circle cx="40" cy="12" r="4" fill="#1e3a5f"/>
    <text x="75" y="16" fill="#7db8e8" font-family="monospace" font-size="10" text-anchor="middle">TRACER</text>
    
    <!-- Código del tracer -->
    <g font-family="monospace" font-size="8" fill="#5a8fba">
      <text x="10" y="42">mov rax, 101</text>
      <text x="10" y="54">mov rdi, 16</text>
      <text x="10" y="66" fill="#4a90d9">; PTRACE_ATTACH</text>
      <text x="10" y="82">mov rsi, r15</text>
      <text x="10" y="94" fill="#4a90d9">; PID target</text>
      <text x="10" y="110" fill="#7db8e8">syscall</text>
    </g>
    <text x="75" y="125" fill="#3a6a9a" font-family="monospace" font-size="8" text-anchor="middle">PID: 1337</text>
  </g>
  
  <!-- Flecha de conexión ptrace -->
  <g filter="url(#glow-cyan)">
    <path d="M 195 90 Q 240 60, 280 90 Q 320 120, 365 90" stroke="#00d4ff" stroke-width="2" fill="none" stroke-dasharray="8,4">
      <animate attributeName="stroke-dashoffset" from="24" to="0" dur="1s" repeatCount="indefinite"/>
    </path>
    <polygon points="365,90 355,85 355,95" fill="#00d4ff"/>
  </g>
  
  <!-- Label ptrace -->
  <rect x="248" y="48" width="64" height="18" rx="3" fill="#0a1520" stroke="#00d4ff" stroke-width="1"/>
  <text x="280" y="60" fill="#00d4ff" font-family="monospace" font-size="9" text-anchor="middle" filter="url(#glow-cyan)">ptrace()</text>
  
  <!-- TRACEE Process Box -->
  <g transform="translate(375, 25)">
    <rect width="150" height="130" rx="6" fill="url(#tracee-grad)" stroke="#a855f7" stroke-width="1.5"/>
    <rect width="150" height="24" rx="6" fill="#3d1a4a"/>
    <rect y="20" width="150" height="4" fill="#3d1a4a"/>
    <circle cx="12" cy="12" r="4" fill="#a855f7"/>
    <circle cx="26" cy="12" r="4" fill="#6b2d8a"/>
    <circle cx="40" cy="12" r="4" fill="#3d1a4a"/>
    <text x="75" y="16" fill="#c084fc" font-family="monospace" font-size="10" text-anchor="middle">TRACEE</text>
    
    <!-- Estado del tracee -->
    <g font-family="monospace" font-size="8">
      <text x="10" y="42" fill="#8b5aa8">RIP: 0x401000</text>
      <text x="10" y="56" fill="#8b5aa8">RSP: 0x7fff...</text>
      <text x="10" y="70" fill="#8b5aa8">RAX: 0x000000</text>
      
      <!-- Status parpadeante -->
      <rect x="10" y="82" width="130" height="16" rx="2" fill="#2d0a3d" stroke="#ff00ff" stroke-width="1">
        <animate attributeName="opacity" values="0.6;1;0.6" dur="1.5s" repeatCount="indefinite"/>
      </rect>
      <text x="75" y="93" fill="#ff00ff" font-size="9" text-anchor="middle">
        <tspan>STOPPED</tspan>
      </text>
      
      <text x="10" y="112" fill="#6b4d8a">PT_PTRACED</text>
    </g>
    <text x="75" y="125" fill="#5a3d7a" font-family="monospace" font-size="8" text-anchor="middle">PID: 5204</text>
  </g>
  
  <!-- Indicador syscall 101 -->
  <text x="280" y="170" fill="#3a4a5a" font-family="monospace" font-size="9" text-anchor="middle">syscall 101 · Process Injection</text>
</svg>
