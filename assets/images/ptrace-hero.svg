<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 400">
  <defs>
    <linearGradient id="bg-ptrace" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0b1220"/>
      <stop offset="50%" style="stop-color:#0a1018"/>
      <stop offset="100%" style="stop-color:#0f1a2c"/>
    </linearGradient>
    <linearGradient id="inject-glow" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#4a6fa5;stop-opacity:0"/>
      <stop offset="50%" style="stop-color:#4a6fa5;stop-opacity:0.8"/>
      <stop offset="100%" style="stop-color:#4a6fa5;stop-opacity:0"/>
    </linearGradient>
    <linearGradient id="arrow-grad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#8b3a3a"/>
      <stop offset="100%" style="stop-color:#c9545a"/>
    </linearGradient>
  </defs>
  
  <!-- Background -->
  <rect width="800" height="400" fill="url(#bg-ptrace)"/>
  
  <!-- Memory addresses background -->
  <g font-family="JetBrains Mono, monospace" font-size="9" fill="#4a6fa5" opacity="0.12">
    <text x="20" y="30">0x7f7a85496000: 48 89 e7 48 31 f6 48 31 d2 b8 3b 00 00 00 0f 05</text>
    <text x="20" y="45">0x7f7a85496010: 48 31 c0 48 31 db 48 31 c9 48 31 d2 48 31 f6 ff</text>
    <text x="20" y="60">0x7f7a85496020: b8 65 00 00 00 48 89 e7 0f 05 48 85 c0 74 1a 48</text>
    <text x="20" y="375">0x7fffffff0000: 41 41 41 41 42 42 42 42 43 43 43 43 44 44 44 44</text>
    <text x="20" y="390">0x7fffffff0010: 00 00 00 00 00 00 00 00 90 90 90 90 90 90 90 90</text>
  </g>
  
  <!-- Process 1: Tracer -->
  <g transform="translate(80, 100)">
    <rect width="200" height="180" rx="8" fill="#0d1420" stroke="#4a6fa5" stroke-width="2"/>
    <rect width="200" height="30" rx="8" fill="#162033"/>
    <text x="100" y="20" font-family="JetBrains Mono, monospace" font-size="11" fill="#7a9ec9" text-anchor="middle">TRACER (injector)</text>
    
    <!-- Code inside -->
    <g font-family="JetBrains Mono, monospace" font-size="10">
      <text x="15" y="55" fill="#6e7681">; PTRACE_ATTACH</text>
      <text x="15" y="75" fill="#8b3a3a">mov</text>
      <text x="45" y="75" fill="#7a9ec9">rax</text>
      <text x="70" y="75" fill="#c9d1d9">, 101</text>
      <text x="15" y="95" fill="#8b3a3a">mov</text>
      <text x="45" y="95" fill="#7a9ec9">rdi</text>
      <text x="70" y="95" fill="#c9d1d9">, 16</text>
      <text x="15" y="115" fill="#8b3a3a">syscall</text>
      <text x="15" y="140" fill="#6e7681">; PTRACE_POKEDATA</text>
      <text x="15" y="160" fill="#8b3a3a">mov</text>
      <text x="45" y="160" fill="#7a9ec9">rdi</text>
      <text x="70" y="160" fill="#c9d1d9">, 5</text>
    </g>
  </g>
  
  <!-- Process 2: Tracee (victim) -->
  <g transform="translate(520, 100)">
    <rect width="200" height="180" rx="8" fill="#0d1420" stroke="#8b3a3a" stroke-width="2"/>
    <rect width="200" height="30" rx="8" fill="#1a1215"/>
    <text x="100" y="20" font-family="JetBrains Mono, monospace" font-size="11" fill="#c9545a" text-anchor="middle">TRACEE (victim)</text>
    
    <!-- Memory regions -->
    <g font-family="JetBrains Mono, monospace" font-size="9">
      <text x="15" y="50" fill="#6e7681">.text</text>
      <rect x="15" y="55" width="170" height="25" rx="3" fill="#141a24" stroke="#3a4a5a" stroke-width="1"/>
      <text x="25" y="72" fill="#4a6fa5">RIP → 0x7f7a854966</text>
      
      <text x="15" y="100" fill="#6e7681">.data</text>
      <rect x="15" y="105" width="170" height="20" rx="3" fill="#141a24" stroke="#3a4a5a" stroke-width="1"/>
      
      <text x="15" y="145" fill="#27ca40">mmap RWX</text>
      <rect x="15" y="150" width="170" height="25" rx="3" fill="#0a1a0a" stroke="#27ca40" stroke-width="1.5">
        <animate attributeName="stroke-opacity" values="0.5;1;0.5" dur="2s" repeatCount="indefinite"/>
      </rect>
      <text x="25" y="167" fill="#27ca40" font-size="8">shellcode injected here</text>
    </g>
  </g>
  
  <!-- Injection arrow -->
  <g>
    <path d="M290 190 L510 190" stroke="url(#arrow-grad)" stroke-width="3" fill="none" stroke-dasharray="8,4">
      <animate attributeName="stroke-dashoffset" values="0;-24" dur="1s" repeatCount="indefinite"/>
    </path>
    <polygon points="510,190 495,182 495,198" fill="#c9545a"/>
    
    <!-- Labels on arrow -->
    <rect x="350" y="170" width="100" height="20" rx="3" fill="#1a1215" stroke="#8b3a3a" stroke-width="1"/>
    <text x="400" y="184" font-family="JetBrains Mono, monospace" font-size="9" fill="#c9545a" text-anchor="middle">INJECT</text>
  </g>
  
  <!-- Ptrace operations list -->
  <g transform="translate(320, 290)">
    <text x="80" y="0" font-family="JetBrains Mono, monospace" font-size="10" fill="#4a6fa5" text-anchor="middle">ptrace operations:</text>
    <g font-family="JetBrains Mono, monospace" font-size="9" fill="#6e7681">
      <text x="0" y="20">ATTACH</text>
      <text x="55" y="20" fill="#3a4a5a">→</text>
      <text x="70" y="20">GETREGS</text>
      <text x="130" y="20" fill="#3a4a5a">→</text>
      <text x="145" y="20">POKEDATA</text>
    </g>
    <g font-family="JetBrains Mono, monospace" font-size="9" fill="#6e7681">
      <text x="0" y="40">SETREGS</text>
      <text x="55" y="40" fill="#3a4a5a">→</text>
      <text x="70" y="40">SINGLESTEP</text>
      <text x="145" y="40" fill="#3a4a5a">→</text>
      <text x="160" y="40" fill="#27ca40">DETACH</text>
    </g>
  </g>
  
  <!-- Syringe icon -->
  <g transform="translate(400, 85)" opacity="0.25">
    <path d="M-15,-25 L15,-25 L15,-15 L10,-15 L10,20 L5,25 L-5,25 L-10,20 L-10,-15 L-15,-15 Z" 
          fill="none" stroke="#8b3a3a" stroke-width="2"/>
    <line x1="0" y1="-25" x2="0" y2="-35" stroke="#8b3a3a" stroke-width="2"/>
    <line x1="-8" y1="-5" x2="8" y2="-5" stroke="#8b3a3a" stroke-width="1"/>
    <line x1="-8" y1="5" x2="8" y2="5" stroke="#8b3a3a" stroke-width="1"/>
    <line x1="-8" y1="15" x2="8" y2="15" stroke="#8b3a3a" stroke-width="1"/>
  </g>
  
  <!-- Bottom accent -->
  <rect x="0" y="395" width="800" height="5" fill="url(#inject-glow)"/>
  
  <!-- Scanline effect -->
  <rect x="0" y="0" width="800" height="2" fill="#4a6fa5" opacity="0.15">
    <animate attributeName="y" values="0;400;0" dur="5s" repeatCount="indefinite"/>
  </rect>
</svg>
