{"config":{"lang":["es"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"RAZOR","text":"Offensive Security Research <p>       Notas t\u00e9cnicas, writeups de CTF y research sobre seguridad ofensiva,       desarrollo de malware, kernel exploitation y m\u00e1s.     </p> <p>       \u26a0\ufe0f Todo el contenido es exclusivamente con fines educativos y de investigaci\u00f3n.     </p> Writeups Research"},{"location":"#secciones","title":"Secciones","text":"CTF Writeups Resoluci\u00f3n de m\u00e1quinas y retos CTF Reference Cheatsheets Referencias r\u00e1pidas y comandos Low-level Research Malware dev, kernel, eBPF"},{"location":"#ultimos-posts","title":"\u00daltimos posts","text":"Fecha T\u00edtulo Categor\u00eda 2025-01-09 Introducci\u00f3n a eBPF Research 2025-01-08 Linux Privilege Escalation Cheatsheet 2025-01-07 Shellcode Basics Research"},{"location":"cheatsheets/","title":"Cheatsheets","text":"<p>Referencias r\u00e1pidas y comandos \u00fatiles para pentesting y CTFs.</p>"},{"location":"cheatsheets/#disponibles","title":"Disponibles","text":"Linux Linux Privilege Escalation T\u00e9cnicas y comandos para escalada de privilegios en Linux"},{"location":"cheatsheets/linux-privesc/","title":"Linux Privilege Escalation","text":"<p>Gu\u00eda de referencia r\u00e1pida para escalada de privilegios en sistemas Linux.</p>"},{"location":"cheatsheets/linux-privesc/#system-info","title":"System info","text":"<pre><code># Sistema\nuname -a\ncat /etc/issue\ncat /etc/*-release\n\n# Hostname\nhostname\n</code></pre>"},{"location":"cheatsheets/linux-privesc/#current-user","title":"Current user","text":"<pre><code>id\nwhoami\nsudo -l\n</code></pre>"},{"location":"cheatsheets/linux-privesc/#users","title":"Users","text":"<pre><code>cat /etc/passwd | grep -E '/bin/(ba)?sh'\ncat /etc/shadow  # si tenemos permisos\n</code></pre>"},{"location":"cheatsheets/linux-privesc/#network","title":"Network","text":"<pre><code>ip a\nss -tulpn\nnetstat -antup\n</code></pre>"},{"location":"cheatsheets/linux-privesc/#suid-binaries","title":"SUID Binaries","text":"<pre><code>find / -perm -4000 -type f 2&gt;/dev/null\nfind / -perm -u=s -type f 2&gt;/dev/null\n</code></pre>"},{"location":"cheatsheets/linux-privesc/#capabilities","title":"Capabilities","text":"<pre><code>getcap -r / 2&gt;/dev/null\n</code></pre>"},{"location":"cheatsheets/linux-privesc/#cron-jobs","title":"Cron Jobs","text":"<pre><code>cat /etc/crontab\nls -la /etc/cron.*\ncrontab -l\n</code></pre>"},{"location":"cheatsheets/linux-privesc/#writable-directories","title":"Writable directories","text":"<pre><code>find / -writable -type d 2&gt;/dev/null\nfind / -perm -222 -type d 2&gt;/dev/null\n</code></pre> <p>GTFOBins</p> <p>Consulta GTFOBins para exploits de binarios SUID.</p> <p>Enlaces \u00fatiles</p> <ul> <li>HackTricks - Linux Privesc</li> <li>PayloadsAllTheThings</li> <li>LinPEAS</li> </ul>"},{"location":"research/","title":"Research","text":"<p>Investigaci\u00f3n y desarrollo en seguridad ofensiva de bajo nivel.</p>"},{"location":"research/#areas-de-investigacion","title":"\u00c1reas de investigaci\u00f3n","text":"Low-level Kernel eBPF, rootkits, syscalls Offensive Malware Development Shellcode, evasion, implants"},{"location":"research/kernel/","title":"Kernel Security","text":"<p>Investigaci\u00f3n sobre seguridad a nivel de kernel Linux.</p>"},{"location":"research/kernel/#articulos","title":"Art\u00edculos","text":"eBPF Introducci\u00f3n a eBPF Fundamentos de eBPF para security research"},{"location":"research/kernel/ebpf-intro/","title":"Introducci\u00f3n a eBPF","text":"<p>eBPF (extended Berkeley Packet Filter) permite ejecutar c\u00f3digo en el kernel Linux de forma segura.</p>"},{"location":"research/kernel/ebpf-intro/#que-es-ebpf","title":"\u00bfQu\u00e9 es eBPF?","text":"<p>eBPF es una tecnolog\u00eda que permite ejecutar programas sandboxed en el kernel Linux sin modificar el c\u00f3digo fuente del kernel ni cargar m\u00f3dulos.</p>"},{"location":"research/kernel/ebpf-intro/#casos-de-uso","title":"Casos de uso","text":"<ul> <li>Observabilidad: tracing, profiling, monitoring</li> <li>Networking: XDP, tc, socket filtering</li> <li>Security: LSM hooks, seccomp</li> </ul>"},{"location":"research/kernel/ebpf-intro/#primer-programa-ebpf","title":"Primer programa eBPF","text":"<pre><code>#include &lt;linux/bpf.h&gt;\n#include &lt;bpf/bpf_helpers.h&gt;\n\nSEC(\"tracepoint/syscalls/sys_enter_execve\")\nint trace_execve(void *ctx) {\n    bpf_printk(\"execve called\\\\n\");\n    return 0;\n}\n\nchar LICENSE[] SEC(\"license\") = \"GPL\";\n</code></pre>"},{"location":"research/kernel/ebpf-intro/#compilar","title":"Compilar","text":"<pre><code>clang -O2 -target bpf -c trace.bpf.c -o trace.bpf.o\n</code></pre>"},{"location":"research/kernel/ebpf-intro/#cargar-con-bpftool","title":"Cargar con bpftool","text":"<pre><code>sudo bpftool prog load trace.bpf.o /sys/fs/bpf/trace\nsudo bpftool prog show\n</code></pre>"},{"location":"research/kernel/ebpf-intro/#bpftrace-one-liners","title":"bpftrace one-liners","text":"<pre><code># Trazar llamadas a open()\nsudo bpftrace -e 'tracepoint:syscalls:sys_enter_open { printf(\"%s %s\\n\", comm, str(args-&gt;filename)); }'\n\n# Contar syscalls por proceso\nsudo bpftrace -e 'tracepoint:raw_syscalls:sys_enter { @[comm] = count(); }'\n\n# Latencia de read()\nsudo bpftrace -e 'tracepoint:syscalls:sys_enter_read { @start[tid] = nsecs; } tracepoint:syscalls:sys_exit_read /@start[tid]/ { @ns = hist(nsecs - @start[tid]); delete(@start[tid]); }'\n</code></pre>"},{"location":"research/kernel/ebpf-intro/#bpf-maps","title":"BPF Maps","text":"<p>Los maps permiten compartir datos entre programas eBPF y userspace.</p> <pre><code>struct {\n    __uint(type, BPF_MAP_TYPE_HASH);\n    __uint(max_entries, 1024);\n    __type(key, u32);\n    __type(value, u64);\n} my_map SEC(\".maps\");\n</code></pre> <p>Requisitos</p> <ul> <li>Kernel &gt;= 4.15 (recomendado &gt;= 5.x)</li> <li>Privilegios CAP_BPF o root</li> <li>Headers del kernel instalados</li> </ul> <p>Referencias</p> <ul> <li>eBPF.io</li> <li>BPF Portability and CO-RE</li> <li>Learning eBPF - Liz Rice</li> </ul>"},{"location":"research/malware-dev/","title":"Malware Development","text":"<p>Disclaimer</p> <p>Este contenido es exclusivamente para fines educativos y de investigaci\u00f3n en entornos autorizados.</p>"},{"location":"research/malware-dev/#articulos","title":"Art\u00edculos","text":"Assembly Shellcode Basics Fundamentos de desarrollo de shellcode x86-64"},{"location":"research/malware-dev/shellcode-basics/","title":"Shellcode Basics","text":"<p>Fundamentos de desarrollo de shellcode para Linux x86-64.</p>"},{"location":"research/malware-dev/shellcode-basics/#que-es-shellcode","title":"\u00bfQu\u00e9 es shellcode?","text":"<p>Shellcode es c\u00f3digo m\u00e1quina dise\u00f1ado para ser inyectado y ejecutado en el contexto de otro proceso.</p>"},{"location":"research/malware-dev/shellcode-basics/#caracteristicas","title":"Caracter\u00edsticas","text":"<ul> <li>Position Independent: no depende de direcciones fijas</li> <li>Null-free: evita bytes nulos (<code>0x00</code>)</li> <li>Peque\u00f1o: menor tama\u00f1o posible</li> </ul>"},{"location":"research/malware-dev/shellcode-basics/#syscall-en-x86-64","title":"Syscall en x86-64","text":"<p>En Linux x86-64, las syscalls se invocan con la instrucci\u00f3n <code>syscall</code>:</p> Registro Prop\u00f3sito <code>rax</code> N\u00famero de syscall <code>rdi</code> Argumento 1 <code>rsi</code> Argumento 2 <code>rdx</code> Argumento 3 <code>r10</code> Argumento 4 <code>r8</code> Argumento 5 <code>r9</code> Argumento 6"},{"location":"research/malware-dev/shellcode-basics/#execvebinsh","title":"execve(\"/bin/sh\")","text":"<pre><code>; Linux x86-64 execve(\"/bin/sh\")\n; nasm -f elf64 shell.asm -o shell.o\n; ld shell.o -o shell\n\nglobal _start\n\nsection .text\n_start:\n    ; Limpiar registros\n    xor rax, rax\n    xor rdx, rdx        ; envp = NULL\n    xor rsi, rsi        ; argv = NULL\n\n    ; Push \"/bin/sh\" a la pila\n    push rax            ; null terminator\n    mov rbx, 0x68732f6e69622f  ; \"/bin/sh\" en little-endian\n    push rbx\n\n    ; rdi = pointer a \"/bin/sh\"\n    mov rdi, rsp\n\n    ; execve(rdi, rsi, rdx)\n    mov al, 59          ; syscall number para execve\n    syscall\n</code></pre>"},{"location":"research/malware-dev/shellcode-basics/#extraer-bytes","title":"Extraer bytes","text":"<pre><code>objdump -d shell.o | grep -Po '\\s\\K[a-f0-9]{2}(?=\\s)' | sed 's/^/\\\\x/g' | tr -d '\\n'\n</code></pre>"},{"location":"research/malware-dev/shellcode-basics/#evitar-null-bytes","title":"Evitar null bytes","text":"<pre><code>; MAL - contiene null bytes\nmov rax, 0x3b           ; 48 c7 c0 3b 00 00 00\n\n; BIEN - sin null bytes  \nxor rax, rax\nmov al, 0x3b            ; 48 31 c0 b0 3b\n</code></pre>"},{"location":"research/malware-dev/shellcode-basics/#testear-shellcode","title":"Testear shellcode","text":"<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nunsigned char shellcode[] = \n    \"\\x48\\x31\\xc0\\x48\\x31\\xd2\\x48\\x31\\xf6\"\n    \"\\x50\\x48\\xbb\\x2f\\x62\\x69\\x6e\\x2f\\x73\"\n    \"\\x68\\x00\\x53\\x48\\x89\\xe7\\xb0\\x3b\\x0f\\x05\";\n\nint main() {\n    printf(\"Shellcode length: %zu\\n\", strlen(shellcode));\n\n    void (*sc)() = (void(*)())shellcode;\n    sc();\n\n    return 0;\n}\n</code></pre> <pre><code>gcc -z execstack -fno-stack-protector -o test test.c\n./test\n</code></pre> <p>Solo en entornos controlados</p> <p>Ejecutar shellcode solo en m\u00e1quinas virtuales o entornos de laboratorio.</p> <p>Referencias</p> <ul> <li>Syscall Table x86-64</li> <li>Shell-Storm Shellcode DB</li> </ul>"},{"location":"writeups/","title":"Writeups","text":"<p>Resoluci\u00f3n de m\u00e1quinas CTF, HackTheBox, TryHackMe y otros retos de seguridad.</p>"},{"location":"writeups/#maquinas-recientes","title":"M\u00e1quinas recientes","text":"Plataforma Nombre Dificultad Fecha HackTheBox Machine1 Medium 2025-01-XX TryHackMe Room1 Easy 2025-01-XX <p>Sobre los writeups</p> <p>Todos los writeups son de m\u00e1quinas retiradas o con permiso de publicaci\u00f3n.</p>"}]}